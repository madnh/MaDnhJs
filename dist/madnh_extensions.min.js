!function(a){var b={};a.App.hasDOMPlugin=function(a){return b.hasOwnProperty(a)},a.App.addDOMPlugin=function(c,d,e){b[c]={callback:d,options:a.isObject(e)?e:{}}},a.App.removeDOMPlugin=function(c){c=a.flatten(a.toArray(arguments)),a.each(c,function(a){delete b[a]})},a.App.applyDOMPlugin=function(c,d,e){var f=a.M.optionalArgs(a.toArray(arguments),["selector","plugins","options"],{selector:function(b){return a.isString(b)||b instanceof $},plugins:"Array",options:"Object"});c=$(f.selector||"body"),d=f.plugins||Object.keys(b),e=f.options||{};var g=a.difference(d,Object.keys(b));if(!a.isEmpty(g))throw new Error(["Apply not found DOM plugin: ",g.join(", ")].join(""));a.each(d,function(d){var f=a.has(e,d)?e[d]:{};b[d].callback(c,a.extend({},b[d].options,f))})}}(_),function(a){function b(b,c){this.type_prefix="template",a.M.EventEmitter.call(this),this.dataSource=null,this.options={},this._layout="",this._sections={},a.isUndefined(c)||self.setLayout(c),a.isObject(b)&&a.each(b,function(a,b){self.setSection(a,b)})}function c(a){for(var b,c=new RegExp("@([A-Z0-9_-]+)@","gi"),d=[];null!==(b=c.exec(a));)d.push(b[1]);return d}function d(b,e,f,g){var h="",i=[];h=a.isFunction(b)?b(e,e.dataSource,g):b+"",i=c(h);var j=a.difference(i,Object.keys(f));return a.isEmpty(j)||(console.warn("Missing subsections:",j),a.each(j,function(a){f[a]="",i[a]=""})),i=a.zipObject(i,a.fill(new Array(i.length),"")),a.isEmpty(i)||(a.each(i,function(a,b){f[b]=d(f[b],e,f,g),i[b]=f[b]}),a.each(i,function(a,b){h=h.replace(new RegExp("@"+b.toUpperCase()+"@","gi"),a)})),h}var e="1.0.0";b.prototype=Object.create(a.M.EventEmitter.prototype),b.prototype.constructor=b,Object.defineProperty(b,"version",{value:e}),b.prototype.option=function(b,c){return this.options=a.M.setup.apply(a.M,[this.options].concat(Array.prototype.slice.apply(arguments))),this},b.prototype.connect=function(b){return null!==this.dataSource&&this.disconnect(),this.dataSource=b,a.M.isEventEmitter(b)&&this.attachHardTo(b),this.emitEvent("connected"),this},b.prototype.disconnect=function(){return null!==this.dataSource?(this.emitEvent("before_disconnect"),a.M.isEventEmitter(this.dataSource)&&(this.dataSource.removeListener(this.id),this.dataSource.detach(this)),this.dataSource=null,this.emitEvent("disconnected"),!0):!1},b.prototype.getDataSource=function(){return this.dataSource},b.prototype.isConnected=function(){return null!==this.dataSource},b.prototype.setLayout=function(a){return this._layout=a,this},b.prototype.getLayout=function(){return this._layout},b.prototype.setSection=function(b,c){return a.isObject(b)?a.each(b,function(a,b){this._sections[b.toUpperCase()]=a}.bind(this)):this._sections[b.toUpperCase()]=c,this},b.prototype.currentDraw=function(){return a.M.currentID(this.id+"_draw",!1)},b.prototype.getDOMID=function(){return this.id},b.prototype.prepareData=function(){return{}},b.prototype.render=function(b){var c,e=this,f=a.extend({},{option:this.options,data_source:this.getDataSource()}),g=a.extend({},this._sections);return a.M.nextID(this.id+"_draw"),f.draw=this.currentDraw(),f.dom_id=this.getDOMID(),a.extend(f,this.prepareData(f),a.isObject(b)?b:{}),c=a.isFunction(this._layout)?this._layout(e,this.dataSource,f):this._layout+"",c=d(c,this,g,f),a.template(c)(f)},b.prototype.rendered=function(){},b.prototype.reDraw=function(a){var b=this.getDOM();if(b){var c=this.render(a);return this.emitEvent("re-draw"),b.first().replaceWith(c),this.emitEvent("drawn",c),this.rendered(),!0}return!1},b.prototype.getDOM=function(){return $("#"+this.getDOMID())};var f={compilers:{},types:{}};b.hasCompiler=function(b){return a.has(f.compilers,b)},b.compiler=function(a,b){f.compilers[a]=b},b.compilers=function(){return Object.keys(f.compilers)},b.render=function(a,b){return this.hasCompiler(a)?(1==arguments.length&&(b={}),f.compilers[a](b)):!1},b.register=function(a,b,c){return f.types.hasOwnProperty(a)||(f.types[a]={_default:null,constructors:{}}),f.types[a].hasOwnProperty(b)?!1:(f.types[a].constructors[b]=c,f.types[a]._default||(f.types[a]._default=b),!0)},b.types=function(b){return b?a.mapObject(f.types,function(a){return Object.keys(a.constructors)}):Object.keys(f.types)},b.hasType=function(a){return f.types.hasOwnProperty(a)},b.templates=function(b,c){return c?Object.keys(f.types[b].constructors):a.clone(f.types[b].constructors)},b.hasTemplate=function(a,b){return f.types.hasOwnProperty(a)&&f.types[a].constructors.hasOwnProperty(b)},b.defaultTemplate=function(b,c){if(!a.isEmpty(f.types[b].constructors)){if(c){if(f.types[b].constructors.hasOwnProperty(c))return f.types[b]._default=c,!0;throw new Error("Set default template with invalid template name")}if(f.types[b]._default&&this.hasTemplate(b,f.types[b]._default))return f.types[b]._default;var d=Object.keys(f.types[b].constructors)[0];return f.types[b]._default=d,new f.types[b].constructors[d]}return!1},b.templateInstance=function(a,b){if(arguments.length<2){var c=this.defaultTemplate(a);if(!1!==c)return new f.types[a].constructors[c]}else if(this.hasTemplate(a,b))return new f.types[a].constructors[b];throw new Error("Template with name isn't exists or invalid type")},a.M.isTemplateInstance=function(a){return a instanceof b},a.M.Template=b}(_),function(a){function b(a){return-1!==[!0,"true","on",1,"1"].indexOf(a)}function c(a){return a.replace(/]/g,"").replace(/\[/g,".")}function d(b,d,e){if(b.attr("name")){var f=b.attr("name"),g=c(f),h=b.val();if("checkbox"===b.attr("type")){if(b.is(":checked")){var i=h.length?h:!0;if(d.find('input[name="'+f+'"]').length>1){if(b.is(":checked"))try{a.M.appendDeep(e,g,i)}catch(j){a.set(e,g,[i])}}else a.isBoolean(i)?a.set(e,g,"on"):a.set(e,g+"."+i,"on")}}else a.set(e,g,h)}}var e="1.0.0",f={};Object.defineProperty(f,"version",{value:e}),f.disable=function(a){$(a).attr("disabled","disabled").prop("disabled",!0)},f.enable=function(a){$(a).removeAttr("disabled").prop("disabled",!1)},f.getSelectOptionTagByValue=function(b,c,d){var e=a.map(a.castArray(c),function(a){return'option[value="'+a+'"]'});return $(d||"body").find('select[name="'+b+'"]').first().find(e.join(", "))},f.setSelectTagValue=function(b,c,d){$(d||"body").find('select[name="'+b+'"]').val(a.castArray(c))},f.removeSelectOptionTags=function(a,b,c){this.getSelectOptionTagByValue(a,b,c).remove()},f.disableSelectOptionTags=function(a,b,c){this.getSelectOptionTagByValue(a,b,c).attr("disabled","disabled").prop("disabled",!0)},f.enableSelectOptionTags=function(a,b,c){this.getSelectOptionTagByValue(a,b,c).removeAttr("disabled","disabled").prop("disabled",!1)},f.setRadioTagValue=function(a,b,c){c=$(c||"body"),c.find("input:radio[name='"+a+"']:checked").prop("checked",!1).removeAttr("checked"),c.find("input:radio[name='"+a+"'][value="+b+"]").prop("checked",!0).attr("checked","checked")},f.getRadioTagValue=function(a,b){return $(b||"body").find("input:radio[name ='"+a+"']:checked").first().val()},f.setCheckBoxStatus=function(a,b){var c=$(a);c.prop("checked",b),b?c.attr("checked","checked"):c.removeAttr("checked")},f.getCheckboxTagsByValue=function(b,c,d){var e=a.map(a.castArray(c),function(a){return'input[type="checkbox"][name="'+b+'"][value="'+a+'"]'});return $(d||"body").find(e.join(", "))},f.setCheckBoxValue=function(c,d,e){e=$(e||"body");var g=e.find('input[type="checkbox"][name="'+c+'"]');return 1===g.length&&(a.isString(d)||a.isNumber(d)||a.isBoolean(d))?void(b(d)?g.attr("checked","checked").prop("checked",!0):g.removeAttr("checked").prop("checked",!1)):(g.removeAttr("checked").prop("checked",!1),void f.getCheckboxTagsByValue(c,d,e).attr("checked","checked").prop("checked",!0))},f.getFormValue=function(a){var b=$(a).find('input:not(input[type="radio"]), textarea, select, input[type="radio"]:checked'),c={};return b.each(function(){d($(this),a,c)}),c},f.assignFormValue=function(b,c,d){return b=$(b),b.length?(a.isString(d)&&!a.isEmpty(d)||(d=""),a.each(c,function(a,c){var e=d+c,g=b.find('*[name="'+e+'"]');if(g.length){var h=g.first();h.is("input")||h.is("textarea")?h.is(":radio")?f.setRadioTagValue(e,a,b):h.is(":checkbox")?f.setCheckBoxValue(e,a,b):h.val(a):h.is("select")?f.setSelectTagValue(e,a,b):h.is("a, button")&&h.html(a)}}),!0):!1},a.M.jForm=f}(_),function(a){function b(a){return a.isEnable()}function c(a){return a.isEnable()}function d(b){var c={status:a.M.DIALOG_STATUS_INITIAL,enabled:!0,pending:!1,loading:!1,ajax_worker:null,template_instance:null};h.hasOwnProperty(b)&&(c.template_instance=h[b].template_instance),h[b]=c}function e(b){this.type_prefix="dialog";var c=this;a.M.EventEmitter.call(this),this.options=a.M.PreOptions.get(a.M.DIALOG_PRE_OPTIONS_NAME),this.closed_by="",this.data={},this.buttons={},d(this.id),this.option(this.options),b&&(b.hasOwnProperty("events")&&b.events&&(this.addListeners(b.events),delete b.events),b.hasOwnProperty("buttons")&&b.buttons&&(a.each(b.buttons,function(a){c.attachButton(a)}),delete b.buttons),this.option(b))}function f(b){a.isFunction(this.options.content_handler)&&(b=this.options.content_handler(b,this)),this.emitEvent("content_loaded",b),this.updateContent(b)}var g="1.0.0";a.M.defineConstant({DIALOG_PRE_OPTIONS_NAME:"_.M.Dialog",DIALOG_TEMPLATE_TYPE:"Dialog",DIALOG_STATUS_INITIAL:"initial",DIALOG_STATUS_OPENED:"opened",DIALOG_STATUS_HIDING:"hiding",DIALOG_STATUS_CLOSED:"removed",DIALOG_INFO:"info",DIALOG_SUCCESS:"success",DIALOG_PRIMARY:"primary",DIALOG_WARNING:"warning",DIALOG_DANGER:"danger",DIALOG_SIZE_SMALL:"small",DIALOG_SIZE_NORMAL:"normal",DIALOG_SIZE_LARGE:"large"});var h={};a.M.PreOptions.define(a.M.DIALOG_PRE_OPTIONS_NAME,{title:"Dialog",type:a.M.DIALOG_INFO,content:"",content_handler:null,template_name:"",template:{},size:a.M.DIALOG_SIZE_NORMAL,closable:b,clickable:c}),a.M.inherit(e,a.M.EventEmitter),Object.defineProperty(e,"version",{value:g}),e.globalOption=function(b){a.M.PreOptions.update(a.M.DIALOG_PRE_OPTIONS_NAME,b)},e.prototype.getContent=function(){return a.isFunction(this.options.content)&&(this.emitEvent("load_content"),this.options.content=this.options.content(f.bind(this),this)),a.isFunction(this.options.content_handler)?this.options.content_handler(this.options.content,this):this.options.content},e.prototype.updateContent=function(a){this.options.content=a,this.isOpened()&&this.emitEvent("update_content",a)},e.prototype.setTemplate=function(b){if(!this.isIniting())throw new Error("Dialog is opened");if(!a.M.isTemplateInstance(b))throw new Error("Invalid Template instance");h[this.id].template_instance&&(h[this.id].template_instance.disconnect(),h[this.id].template_instance=null),b.option(this.options.template),h[this.id].template_instance=b,b.connect(this)},e.prototype.getTemplate=function(){if(!h[this.id].template_instance){if(!this.options.template_name){var b=a.M.PreOptions.get(a.M.DIALOG_PRE_OPTIONS_NAME);if(b.template_name&&a.M.Template.hasTemplate(a.M.DIALOG_TEMPLATE_TYPE,b.template_name))this.options.template_name=b.template_name;else{var c=a.M.Template.defaultTemplate(a.M.DIALOG_TEMPLATE_TYPE);if(!1===c)throw new Error("Dialog default template not found");this.options.template_name=c,a.M.PreOptions.update(a.M.DIALOG_PRE_OPTIONS_NAME,{template_name:c})}}this.setTemplate(a.M.Template.templateInstance(a.M.DIALOG_TEMPLATE_TYPE,this.options.template_name))}return h[this.id].template_instance},e.prototype.option=function(b,c){var d=a.M.beObject.apply(a.M,a.toArray(arguments));return d.template_name&&this.setTemplate(a.M.Template.templateInstance(a.M.DIALOG_TEMPLATE_TYPE,d.template_name)),d.template&&this.getTemplate().option(d.template),a.extend(this.options,d),this},e.prototype.status=function(){return h.hasOwnProperty(this.id)?h[this.id].status:!1},e.prototype.isIniting=function(){return this.status()===a.M.DIALOG_STATUS_INITIAL},e.prototype.isOpened=function(){return-1!==[a.M.DIALOG_STATUS_OPENED,a.M.DIALOG_STATUS_HIDING].indexOf(this.status())},e.prototype.isVisibling=function(){return this.status()===a.M.DIALOG_STATUS_OPENED},e.prototype.isHiding=function(){return this.status()===a.M.DIALOG_STATUS_HIDING},e.prototype.isClosed=function(){return this.status()===a.M.DIALOG_STATUS_CLOSED},e.prototype.isEnable=function(){return Boolean(h[this.id].enabled)},e.prototype.isPending=function(){return Boolean(h[this.id].pending)},e.prototype.enable=function(){return this.isEnable()?!1:(h[this.id].enabled=!0,this.emitEvent("enabled"),this.emitEvent("toggle_enable",!0),!0)},e.prototype.disable=function(){return this.isEnable()?(h[this.id].enabled=!1,this.emitEvent("disabled"),this.emitEvent("toggle_enable",!1),!0):!1},e.prototype.pending=function(){return this.isPending()?!1:(h[this.id].pending=!0,this.emitEvent("pending"),this.emitEvent("toggle_pending",!0),!0)},e.prototype.resolved=function(){return this.isPending()?(h[this.id].pending=!1,this.emitEvent("resolved"),this.emitEvent("toggle_pending",!1),!0):!1},e.prototype.attachButton=function(b){if(!a.M.isDialogButton(b))if(a.isObject(b))b=new a.M.DialogButton(b);else{if(!a.isString(b)&&!a.isNumber(b)||!a.M.DialogButton.has(b))throw new Error("Invalid button");b=a.M.DialogButton.factory(b)}return this.buttons[b.options.name]=b,this.attachHard(b),b},e.prototype.attachMultiButtons=function(b){var c=this;a.each(b,function(a){c.attachButton(a)})},e.prototype.hasButton=function(a){return this.buttons.hasOwnProperty(a)},e.prototype.getButton=function(a){if(!this.hasButton(a))throw new Error("Get unattached button");return this.buttons[a]},e.prototype.removeButton=function(a){if(!this.hasButton(a))throw new Error("Remove unattached button");this.detach(this.buttons[a]),delete this.buttons[a]},e.prototype.isClickable=function(){return this.options.clickable?a.isFunction(this.options.clickable)?this.options.clickable(this):Boolean(this.options.clickable):!0},e.prototype.click=function(a){if(this.isClickable()&&this.hasButton(a)){var b=this.getButton(a);b.click(),this.emitEvent("clicked",a)}return!1},e.prototype.isCloseable=function(){return this.isOpened()?this.options.closable?a.isFunction(this.options.closable)?this.options.closable(this):Boolean(this.options.closable):!0:!1},e.prototype.open=function(){return this.status()===a.M.DIALOG_STATUS_INITIAL?(h[this.id].template_instance||this.getTemplate(),this.closed_by="",h[this.id].status=a.M.DIALOG_STATUS_OPENED,this.emitEvent("open"),!0):!1},e.prototype.hide=function(){return this.isVisibling()?(this.emitEvent("hide"),h[this.id].status=a.M.DIALOG_STATUS_HIDING,!0):!1},e.prototype.show=function(){return this.isHiding()?(this.emitEvent("show"),h[this.id].status=a.M.DIALOG_STATUS_OPENED,!0):!1},e.prototype.close=function(b,c){return this.isClosed()||!b&&!this.isCloseable()?!1:(c=c||"",this.emitEvent("close",[b,c]),d(this.id),h[this.id].status=a.M.DIALOG_STATUS_CLOSED,this.closed_by=c,this.emitEvent("closed",[b,c]),this.resetEvents(),!0)},e.prototype.setClosedBy=function(b){return this.isClosed()?(b||(b=""),a.M.isDialogButton(b)&&(b=b.getCloseKey()),a.isString(b)||(b+=""),this.closed_by=b,!0):!1},e.prototype.isClosedBy=function(b){return this.isClosed()?(b||(b=""),a.M.isDialogButton(b)&&(b=b.getCloseKey()),a.isString(b)||(b+=""),this.closed_by===b):!1},e.prototype.getDOM=function(){return h[this.id].template_instance&&a.M.isTemplateInstance(h[this.id].template_instance)?h[this.id].template_instance.getDOM():!1},a.M.Dialog=e,a.M.isDialog=function(a){return a instanceof e}}(_),function(a){function b(a){return a.isVisible()&&a.isEnable()&&a.getDialog().isClickable()}function c(b){this.type_prefix="dialog_button",a.M.EventEmitter.call(this),this.options=a.M.PreOptions.get(a.M.DIALOG_BUTTON_PRE_OPTIONS_NAME,{name:this.id}),j[this.id]={dialog:null,enabled:!0,visible:!0,template_instance:null},this.option(this.options),b&&(b.hasOwnProperty("events")&&(this.addListeners(b.events),delete b.events),this.option(b)),d(this)}function d(a){a.on("attached",e),a.on("detached",f),a.on("dialog.toggle_enable",g),a.on("dialog.toggle_pending",h)}function e(b){b instanceof a.M.Dialog&&(j[this.id].dialog=b)}function f(b){b instanceof a.M.Dialog&&(j[this.id].dialog=null)}function g(a){this.toggleEnable(a.data)}function h(a){a.data?this.options.disable_on_pending&&this.toggleEnable(!1):this.toggleEnable(!0)}var i="1.0.0";a.M.defineConstant({DIALOG_BUTTON_PRE_OPTIONS_NAME:"_.M.DialogButton",DIALOG_BUTTON_TEMPLATE_TYPE:"DialogButton",BUTTON_INFO:"info",BUTTON_PRIMARY:"primary",BUTTON_SUCCESS:"success",BUTTON_WARNING:"warning",BUTTON_DANGER:"danger"}),a.M.defineConstant({BUTTON_OK:"ok",BUTTON_CANCEL:"cancel",BUTTON_YES:"yes",BUTTON_NO:"no",BUTTON_RETRY:"retry",DIALOG_BUTTON_OK_ONLY:["ok"],DIALOG_BUTTON_OK_CANCEL:["ok","cancel"],DIALOG_BUTTON_YES_NO:["yes","no"],DIALOG_BUTTON_YES_NO_CANCEL:["yes","no","cancel"],DIALOG_BUTTON_RETRY_CANCEL:["retry","cancel"]});var j={};a.M.PreOptions.define(a.M.DIALOG_BUTTON_PRE_OPTIONS_NAME,{label:"Untitled",icon:"",type:a.M.BUTTON_INFO,size:1,handler:null,disable_on_pending:!0,clickable:b,template_name:"",template:{}}),a.M.inherit(c,a.M.EventEmitter),Object.defineProperty(c,"version",{value:i}),c.globalOption=function(b){a.M.PreOptions.update(a.M.DIALOG_BUTTON_PRE_OPTIONS_NAME,b)},c.prototype.setTemplate=function(b){if(!a.M.isTemplateInstance(b))throw new Error("Invalid Template instance");j[this.id].template_instance&&(j[this.id].template_instance.disconnect(),j[this.id].template_instance=null),b.option(this.options.template),j[this.id].template_instance=b,b.connect(this)},c.prototype.getTemplate=function(){if(!j[this.id].template_instance){if(!this.options.template_name){var b=a.M.PreOptions.get(a.M.DIALOG_BUTTON_PRE_OPTIONS_NAME);if(b.template_name&&a.M.Template.hasTemplate(a.M.DIALOG_BUTTON_TEMPLATE_TYPE,b.template_name))this.options.template_name=b.template_name;else{var c=a.M.Template.defaultTemplate(a.M.DIALOG_BUTTON_TEMPLATE_TYPE);if(!1===c)throw new Error("Dialog button default template not found");this.options.template_name=c,a.M.PreOptions.update(a.M.DIALOG_BUTTON_PRE_OPTIONS_NAME,{template_name:c})}}this.setTemplate(a.M.Template.templateInstance(a.M.DIALOG_BUTTON_TEMPLATE_TYPE,this.options.template_name))}return j[this.id].template_instance},c.prototype.option=function(b,c){var d=a.M.beObject.apply(a.M,a.toArray(arguments));return d.template_name&&this.setTemplate(a.M.Template.templateInstance(a.M.DIALOG_BUTTON_TEMPLATE_TYPE,d.template_name)),d.template&&this.getTemplate().option(d.template),a.extend(this.options,a.omit(d,["template_name"])),this},c.prototype.setHandler=function(a){this.option("handler",a)},c.prototype.getDialog=function(){return j[this.id].dialog?j[this.id].dialog:!1},c.prototype.isClickable=function(){return a.isFunction(this.options.clickable)?this.options.clickable.call(this,this):Boolean(this.options.clickable)},c.prototype.isVisible=function(){return Boolean(j[this.id].visible)},c.prototype.isEnable=function(){return Boolean(j[this.id].enabled)},c.prototype.click=function(){return this.isClickable()?(this.emitEvent("click"),this.options.handler&&a.M.callFunc(this.options.handler,this,this),this.emitEvent("clicked"),!0):!1},c.prototype.toggle=function(b){a.isUndefined(b)&&(b=!j[this.id].visible),j[this.id].visible!=b&&(j[this.id].visible=b,b?this.emitEvent("show"):this.emitEvent("hide"),this.emitEvent("toggle",b))},c.prototype.show=function(){this.toggle(!0)},c.prototype.hide=function(){this.toggle(!1)},c.prototype.toggleEnable=function(b){a.isUndefined(b)&&(b=!j[this.id].enabled),j[this.id].enabled!==b&&(j[this.id].enabled=b,this.emitEvent(b?"enabled":"disabled"),this.emitEvent("toggle_enable",b))},c.prototype.disable=function(){this.toggleEnable(!1)},c.prototype.enable=function(){this.toggleEnable(!0)},c.prototype.render=function(){return this.getTemplate().render()},c.prototype.reDraw=function(){return j[this.id].template_instance?j[this.id].template_instance.reDraw():!1},c.prototype.getDOM=function(){return j[this.id].template_instance&&a.M.isTemplateInstance(j[this.id].template_instance)?j[this.id].template_instance.getDOM():!1},c.prototype.getOtherButton=function(a){return this.getDialog().getButton(a)},c.prototype.getCloseKey=function(){return this.options.name},c.prototype.closeDialog=function(a){var b=this.getDialog();return b?(b.close(a,this.getCloseKey()),!0):!1},c.prototype.wasCloseDialog=function(){var a=this.getDialog();return a?a.setClosedBy(this):!1};var k={};c.isDefined=function(a){return k.hasOwnProperty(a)},c.define=function(b,c,d){k[b]={options:a.isObject(c)?c:{},freeze_options:a.isObject(d)?d:{}},k[b].freeze_options.name=b},c.updateOptions=function(b,d){return c.isDefined(b)?(a.extend(k[b].options,d),!0):!1},c.factory=function(b,d,e){a.isObject(d)||(d={}),a.isObject(e)||(e={});var f=a.castArray(b).map(function(b){var f,g;if(!c.isDefined(b))throw new Error("Dialog Button type is unregistered");return g=k[b],f=a.extend({},g.options,a.clone(d),e.hasOwnProperty(b)?e[b]:{},g.freeze_options),new c(f)});return 1==f.length?f.shift():f},c.defaultClickable=b,a.M.DialogButton=c,a.M.isDialogButton=function(a){return a instanceof c},a.each(["Ok","Yes","No","Retry","Ignore"],function(a){c.define(a.toLowerCase(),{label:a})}),c.define("cancel",{label:"Cancel",disable_on_pending:!1}),function(a){function b(a){var b=a.getDialog();b&&a.closeDialog(Boolean(a.options.force))}a.M.defineConstant({BUTTON_CLOSE:"close"}),c.define(a.M.BUTTON_CLOSE,{label:"Close",type:a.M.BUTTON_INFO,force:!1},{handler:b})}(a)}(_),function(a){a.M.defineConstant({DIALOG_DYNAMIC_CONTENT_PRE_OPTIONS_NAME:"_.M.Dialog.DynamicContent"}),a.M.PreOptions.define(a.M.DIALOG_DYNAMIC_CONTENT_PRE_OPTIONS_NAME,{loading:"Loading content..."}),a.M.Dialog.dynamicContent=function(b){var c=null;return b=a.M.PreOptions.get(a.M.DIALOG_DYNAMIC_CONTENT_PRE_OPTIONS_NAME,b),function(d,e){if(!a.isNull(c))return c;var f=new a.M.AJAX(a.omit(b,"loading"));return f.done(function(a){c=a+"",d(c)}),f.fail(function(){e.emitEvent("load_content_failed"),d(b.error_content||"Get dynamic content failed")}),f.option("before_send",function(){return e.emitEvent("load_content"),e.pending(),!0}),f.always(function(){e.emitEvent("load_content_complete"),e.resolved()}),f.request(),b.loading}}}(_),function(a){a.M.defineConstant({DIALOG_ALERT_PRE_OPTIONS_NAME:"_.M.Dialog.Alert"}),a.M.PreOptions.define(a.M.DIALOG_ALERT_PRE_OPTIONS_NAME,{title:"Alert",close_button_options:{}}),a.M.Dialog.alert=function(b,c){a.isObject(c)||(c={title:c+""}),c=a.extend(a.M.PreOptions.get(a.M.DIALOG_ALERT_PRE_OPTIONS_NAME,c),{content:b});var d=new a.M.Dialog(a.omit(c,"close_button_options"));return d.attachButton(a.M.DialogButton.factory("close",c.close_button_options)),d.open(),d}}(_),function(a){a.M.defineConstant({DIALOG_CONFIRM_PRE_OPTIONS_NAME:"_.M.Dialog.Confirm"}),a.M.PreOptions.define(a.M.DIALOG_CONFIRM_PRE_OPTIONS_NAME,{title:"Confirm",default_button:null,buttons:[]}),a.M.Dialog.confirm=function(b,c,d){var e;return a.isObject(d)||(d={title:d+""}),a.isFunction(c)||(c=a.noop),d=a.extend(a.M.PreOptions.get(a.M.DIALOG_CONFIRM_PRE_OPTIONS_NAME,d),{content:b}),a.isEmpty(d.buttons)&&(d.buttons=a.M.DialogButton.factory(a.M.DIALOG_BUTTON_YES_NO)),e=new a.M.Dialog(a.omit(d,"default_button")),a.each(e.buttons,function(a){a.setHandler(function(){this.closeDialog(),c(this.options.name)})}),d.default_button||(d.default_button=a.last(Object.keys(e.buttons))),e.on("closed",function(){this.closed_by||a.M.callFunc(c,d.default_button,null)},{key:"default_button"}),e.open(),e}}(_),function(a){a.M.defineConstant({DIALOG_IFRAME_PRE_OPTIONS_NAME:"_.M.Dialog.iFrame"}),a.M.PreOptions.define(a.M.DIALOG_IFRAME_PRE_OPTIONS_NAME,{title:"iFrame",attributes:{}}),a.M.Dialog.iFrame=function(b,c){var d,e=[],f=[];return a.isObject(c)||(c={title:c+""}),c=a.M.PreOptions.get(a.M.DIALOG_IFRAME_PRE_OPTIONS_NAME,c),a.each(c.attributes,function(b,c){a.isBoolean(b)?b&&e.push(c+'="'+c+'"'):e.push(c+'="'+b+'"')}),f.push('<div class="embed-responsive embed-responsive-16by9">'),f.push('<iframe class="embed-responsive-item" src="'+b+'" '+e.join(" ")+"></iframe>"),f.push("</div>"),c.content=f.join("\n"),d=new a.M.Dialog(c),d.open(),d}}(_),function(a){function b(b){return function(c){var d=c.getDialog();c.closeDialog(!0),a.M.callFunc(b,[c.options.name,null,c,d],d)}}function c(b,c){return function(d){var e=this.getDialog(),g=$(e.data.form_selector),h=!0;return f(e,!1),c.validator&&(h=c.validator(g,e)),!0!==h?void f(e,h):void a.M.callFunc(b,[d.options.name,g,d,e],e)}}function d(a){return['<form><div class="dialog_form_message"></div>',a,'<input type="submit" style="display: none;"/></form>'].join("")}function e(b){return a.isArray(b)||(b+"").split(" "),b=a.flatten(a.castArray(b)),a.isEmpty(b)?"":a.map(b,function(a){return a.trim()?"."+a:""}).join("")}function f(a,b){var c=$(a.data.form_selector+" "+a.data.form_message_selector);c.length&&(b?c.html(b).show():c.html("").hide())}function g(a,b){var c="#"+a.getTemplate().getDOMID(),d=c+" form"+e(b.form_classes),f=d+" "+b.message_classes?e(b.message_classes):".dialog_form_message";a.data.form_selector=d,a.data.form_message_selector=f}function h(b){b.getFormDOM=function(){return $(b.data.form_selector)},b.updateFormMessage=function(a){f(b,a)},b.clearFormMessage=function(){f(b,!1)},b.getFormData=function(){return a.M.jForm?a.M.jForm.getFormData(this.getFormDOM()):(console.warn("Method getFormData require module jForm"),{})}}function i(a,b){function c(c){return c.preventDefault(),b.submit_button_name&&a.click(b.submit_button_name),!1}a.on("open",function(){$("body").on("submit",this.data.form_selector,c)}),a.on("closed",function(){if(!this.closed_by&&b.cancel_button_name){if(!this.hasButton(b.cancel_button_name))throw new Error("Invalid default button");this.buttons[b.cancel_button_name].click()}},{key:"default_close_button"}),a.on("closed",function(){$("body").off("submit",this.data.form_selector,c)})}a.M.DialogButton.define("submit",{label:"Submit"}),a.M.defineConstant({BUTTON_SUBMIT:"submit",DIALOG_BUTTON_SUBMIT_CANCEL:["submit","cancel"]}),a.M.defineConstant({DIALOG_FORM_PRE_OPTIONS_NAME:"_.M.Dialog.Form"}),a.M.PreOptions.define(a.M.DIALOG_FORM_PRE_OPTIONS_NAME,{title:"Form",form_classes:"",message_classes:"dialog_form_message",validator:null,auto_focus:!0,submit_button_name:"submit",cancel_button_name:"cancel",buttons:[],buttons_extend_options:{}}),a.M.Dialog.form=function(e,f,j){var k=new a.M.Dialog;return a.isFunction(f)||(f=a.noop),j=a.extend(a.M.PreOptions.get(a.M.DIALOG_FORM_PRE_OPTIONS_NAME,j),{content:e,content_handler:d}),a.isEmpty(j.buttons)&&(j.buttons=a.M.DialogButton.factory(a.M.DIALOG_BUTTON_SUBMIT_CANCEL,{},{cancel:{handler:b(f)},submit:{handler:c(f,j)}})),k.option(a.omit(j,["form_classes","message_classes","validator","submit_button_name","cancel_button_name","buttons","buttons_extend_options"])),a.each(j.buttons,function(b){var c=k.attachButton(b);j.buttons_extend_options.hasOwnProperty(c.options.name)&&c.option(a.clone(j.buttons_extend_options[c.options.name]))}),g(k,j),h(k,j),i(k,j),k.open(),j.auto_focus&&setTimeout(function(){k.getDOM().find("input:visible, textarea:visible").first().focus()},500),k}}(_),function(a){a.M.defineConstant({DIALOG_PROMPT_PRE_OPTIONS_NAME:"_.M.Dialog.prompt"}),a.M.PreOptions.define(a.M.DIALOG_PROMPT_PRE_OPTIONS_NAME,{title:"Prompt",default_value:"",placeholder:"",input_type:"text",input_classes:"form-control",buttons_extend_options:{submit:{label:"Ok"}}}),a.M.Dialog.prompt=function(b,c,d){function e(a,b,e){if(!b)return void c(!1);var f=d.default_value;"submit"===a&&(f=b.find('input[name="prompt_data"]').val(),e.closeDialog()),c(f)}var f,g=[];return a.isObject(d)||(d={title:d+""}),a.isFunction(c)||(c=a.noop),d=a.M.PreOptions.get(a.M.DIALOG_PROMPT_PRE_OPTIONS_NAME,d),g.push("<p>",b,"</p>"),g.push('<input name="prompt_data" type="',d.input_type+'" ','class="',d.input_classes+'" ','value="',d.default_value+'"','placeholder="',d.placeholder+'"',"/>"),f=a.M.Dialog.form(g.join(""),e,a.omit(d,"default_value","placeholder","input_type","input_classes"))}}(_),function(a){function b(a,b,c){var d=b.options.type?"bg-"+b.options.type:"";return'<div class="modal-header '+d+'"><button type="button" class="close" onclick="'+c.close_func+'()"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+b.options.title+"</h4></div>"}function c(a,b,c){var d=b.getContent(),e=[];return this.options.padding||e.push("padding: 0px;"),e.push("overflow: "+this.options.overflow+";"),['<div class="modal-body" style="',e.join(" "),'">',d,"</div>"].join("")}function d(b,c,d){var e=[],f='<div class="modal-footer" style="text-align: '+this.options.buttons_align+';">',g='<span class="dialog-pending-info text-muted pull-'+("left"===this.options.buttons_align?"right":"left")+'">'+this.options.pending_info+"</span>&nbsp;&nbsp;";return a.each(c.buttons,function(a){e.push(a.render())}),f+=e.join("\n")+g,f+="</div>"}function e(a,b,c){var d={large:"lg",small:"sm"},e="",f=['<div class="modal fade" tabindex="-1" role="dialog" id="<%= dom_id %>" data-dialog-id="',b.id,'" data-draw="<%- draw %>">'];return d.hasOwnProperty(this.options.size)&&(e="modal-"+d[this.options.size]),f.push('<div class="modal-dialog ',e,'">','<div class="modal-content">'),this.options.has_header&&f.push("@HEADER@"),f.push("@BODY@"),this.options.has_footer&&f.push("@FOOTER@"),f.push("</div></div></div>"),f.join("")}function f(a){return{backdrop:a?"static":!0,keyboard:!a}}function g(){var b,c=f(this.options.close_manual),d=this.getDialog(),e={};e.close_func=a.M.WAITER.createFunc(function(){this.getDialog().close()}.bind(this),!0,"Modal: "+d.id+" >>> Header close button"),this.waiter_keys.push(e.close_func),b=this.render(e),$("body").append(b),h(this),this.getDOM().modal(c)}function h(a){var b=a.getDOM();b.on("show.bs.modal",function(c){$(c.target).is(b)&&(l++,a.emitEvent("show"))}),b.on("shown.bs.modal",function(c){$(c.target).is(b)&&($("body .modal-backdrop").last().attr("id","modal-backdrop_"+a.id),a.emitEvent("shown"))}),b.on("hide.bs.modal",function(c){$(c.target).is(b)&&a.emitEvent("hide")}),b.on("hidden.bs.modal",function(c){$(c.target).is(b)&&(a.emitEvent("hidden"),a.getDialog().close())})}function i(){var a=this.getDialog().isCloseable(),b=this.getDOM();b.find(".modal-header .close").toggleClass("hide",!a)}function j(){if(!$.fn.modal)throw new Error("Dialog Bootstrap template require Bootstrap Modal to work");this.type_prefix="template_dialog_bootstrap",a.M.Template.call(this),this.options=a.M.PreOptions.get(a.M.DIALOG_TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME),this.waiter_keys=[],this.setLayout(e),this.setSection("HEADER",b.bind(this)),this.setSection("BODY",c.bind(this)),this.setSection("FOOTER",d.bind(this)),this.mimic("open","toggle_enable","close","hide","show","update_content"),this.on("open",g.bind(this)),this.on("toggle_enable",i.bind(this)),this.on("close",function(){a.M.WAITER.remove(this.waiter_keys),this.waiter_keys=[],this.getDOM().modal("hide"),this.getDOM().remove(),l=Math.max(0,--l),$("body").toggleClass("modal-open",l>0),l||$("body .modal-backdrop").remove(),$("#modal-backdrop_"+this.id).remove()}),this.on("hide",function(){this.getDOM().hide(),$("#modal-backdrop_"+this.id).hide()}),this.on("show",function(){this.getDOM().show(),$("#modal-backdrop_"+this.id).show()}),this.on("update_content",function(a){this.getDialog().isOpened()&&this.updateContent(a)})}var k="1.0.0";a.M.defineConstant({DIALOG_TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME:"_.M.Dialog.Template.Bootstrap"}),a.M.PreOptions.define(a.M.DIALOG_TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME,{has_header:!0,has_footer:!0,close_manual:!0,padding:!0,overflow:"hidden",buttons_align:"right",pending_info:""});var l=0;a.M.inherit(j,a.M.Template),Object.defineProperty(j,"version",{value:k}),j.prototype.getDialog=function(){return this.dataSource},j.prototype.updateContent=function(a){a||(a=this.getDialog().options.content),this.getDOM().find(".modal-body").html(a)},j.prototype.updatePendingInfo=function(a){this.getDOM().find(".dialog-pending-info").html(a)},a.M.Template.register(a.M.DIALOG_TEMPLATE_TYPE,"Bootstrap",j)}(_),function(a){function b(a,b,c){return b.options.icon?'<span class="<%= option.icon_class %>"><i class="<%= data_source.options.icon %>"></i></span>&nbsp;&nbsp;':""}function c(b,c,d){
var e=a.clamp(c.options.size-1,0,4),f=a.repeat("&nbsp;&nbsp;",3*e),g="",h=[];return c.isVisible()||h.push("display: none"),g+='<button type="button" id="<%= dom_id %>" data-button-id="<%= data_source.id %>"',g+='data-draw="<%- draw %>" style="'+h.join("; ")+'"',g+='class="btn btn-<%= data_source.options.type %>" data-name="<%= data_source.options.name %>" ',g+='onclick="'+b.click_key+'()"',c.isEnable()||(g+=' disabled="disabled"'),g+=">",g+=f+"@ICON@@LABEL@"+f+"</button>"}function d(){this.type_prefix="template_dialog_button_bootstrap",a.M.Template.call(this);var d=this;this.options=a.M.PreOptions.get(a.M.DIALOG_BUTTON_TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME),this.setLayout(c),this.setSection("ICON",b.bind(this)),this.setSection("LABEL",'<span class="<%= option.label_class %>"><%= data_source.options.label %></span>'),this.click_key=a.M.WAITER.createFunc(function(){d.getButton().click()}),this.mimic("toggle","toggle_enable"),this.on("toggle",function(a){this.getDOM().toggle(a.data)}),this.on("toggle_enable",function(a){a?this.getDOM().removeAttr("disabled"):this.getDOM().attr("disabled","disabled"),this.getDOM().prop("disabled",!a)})}var e="1.0.0";a.M.defineConstant({DIALOG_BUTTON_TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME:"_.M.DialogButton.Template.Bootstrap"}),a.M.PreOptions.define(a.M.DIALOG_BUTTON_TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME,{icon_class:"dialog_button_icon",label_class:"dialog_button_label"}),a.M.inherit(d,a.M.Template),Object.defineProperty(d,"version",{value:e}),d.prototype.getButton=function(){return this.dataSource},d.prototype.updateLabel=function(a){this.getDOM().find("."+this.options.label_class).html(a)},d.prototype.updateIcon=function(a){this.getDOM().find("."+this.options.icon_class).html('<i class="'+a+'"></i>')},a.M.Template.register(a.M.DIALOG_BUTTON_TEMPLATE_TYPE,"Bootstrap",d)}(_);
//# sourceMappingURL=madnh_extensions.min.js.map
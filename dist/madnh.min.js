!function(a){function b(b,c,d){return d||a.isUndefined(d)?b+"_"+c:c}function c(a,b){return a!==b}function d(a,b){return a!=b}function e(b,e,f){if(arguments.length<2)return{};var g={};return a.isFunction(b)||(b=b?c:d),f=l.mergeObject.apply(l,m.call(arguments,2)),a.each(e,function(a,c){f.hasOwnProperty(c)?b(a,f[c])&&(g[c]=a):g[c]=a}),g}function f(a,b){var c=[];return arguments.length>1&&c.push(b),function(){console[a].apply(console,c.concat(m.apply(arguments)))}}function g(a,b){return a-b}function h(a,b){return b-a}function i(a,b){return a===b}function j(a,b){return a==b}var k="1.2.8",l={};Object.defineProperty(l,"VERSION",{value:k});var m=Array.prototype.slice;a.mixin({module:function(b,c){Object.defineProperty(a,b.toString(),{value:c})}}),a.module("M",l),l.sliceArguments=function(a,b,c){return m.apply(a,m.call(arguments,1))},l.beNumber=function(b,c){return b=parseFloat(b),l.isNumeric(b)?b:a.isUndefined(c)?0:l.isNumeric(c)?parseFloat(c):l.beNumber(c,0)},l.beArray=function(b){return a.isArray(b)?b:[b]},l.beObject=function(b,c){switch(!0){case 1==arguments.length:return a.isObject(b)?b:a.isArray(b)||a.isArguments(b)?a.object(Object.keys(b),b):{0:b};case arguments.length>=2:if(a.isObject(b))return b;var d={};return d[b]=c,d}return{}};var n={};n.string=function(a){return a+""},n["boolean"]=function(a){return Boolean(a)},n.number=function(a){return l.beNumber(a)},n.integer=function(a){return Math.floor(l.beNumber(a))},n.array=l.beArray,n.object=function(a){return l.beObject(a)},l.castItemsType=function(b,c){if(!n.hasOwnProperty(c))throw new Error("Invalid cast type. Available types are: string, number, integer, array and object");return a.isArray(b)?a.map(a.clone(b),n[c]):a.mapObject(a.clone(b),n[c])},l.loop=function(b,c,d){var e,f;if(a.isUndefined(d)&&(d="break"),a.isArray(b))for(e=0,f=b.length;f>e&&c(b[e],e,b)!==d;e++);else{var g=a.keys(b);for(e=0,f=g.length;f>e&&c(b[g[e]],g[e],b)!==d;e++);}return b},l.removeKeys=function(b,c){var d,e=a.flatten(m.call(arguments,1)),f=[];return 1==e.length&&a.isFunction(e[0])?(d=Object.keys(b),b=a.omit(b,e[0]),f=a.difference(d,Object.keys(b))):a.each(e,function(c){a.has(b,c)&&(f.push(c),b[c]=void 0,delete b[c])}),f};var o={};l.nextID=function(c,d){return a.isEmpty(c)&&(c="unique_id"),o.hasOwnProperty(c)?o[c]++:o[c]=1,b(c,o[c],d)},l.currentID=function(c,d){return a.isEmpty(c)&&(c="unique_id"),o.hasOwnProperty(c)?b(c,o[c],d):!1},l.resetID=function(b,c){return a.isEmpty(b)&&(b="unique_id"),a.isUndefined(c)?delete o[b]:(c=arguments.length>1?l.beNumber(c):0,c=Math.max(c,0),o[b]=c),c},l.className=function(a,b){return b?a.constructor.name:Object.prototype.toString.call(a)},l.contentType=function(a){var b=typeof a;if("object"===b){var c=l.className(a,!0);if(c)return c}return b},l.isInstanceOf=function(a,b){return l.className(a,!0)===b},l.isPrimitiveType=function(a){var b=typeof a;return null==a||"string"===b||"number"===b||"boolean"===b},l.mergeArray=function(){switch(arguments.length){case 0:return[];case 1:return arguments[0]}for(var a=1;a<arguments.length;a++)for(var b=0;b<arguments[a].length;b+=1e3)arguments[0].push.apply(arguments[0],arguments[a].slice(b,b+1e3));return arguments[0]},l.mergeObject=function(){for(var b=0,c=0,d=arguments.length;d>c;c++)!a.isArray(arguments[c])&&a.isObject(arguments[c])||(arguments[c]=l.beArray(arguments[c]),arguments[c]=a.object(a.range(b,b+=arguments[c].length),arguments[c]));return a.extend.apply(a,arguments)},l.diffObject=function(b,d){var f=a.flatten(a.toArray(arguments));return f.unshift(c),e.apply(null,f)},l.diffObjectLoose=function(b,c){var f=a.toArray(arguments);return f.unshift(d),e.apply(null,f)},l.diffObjectWithCallback=function(a,b,c){return e.apply(null,m.apply(arguments))},l.hasDeep=function(b,c,d){a.isArray(c)||(c=(c+"").split(d||"."));for(var e,f=b;e=c.shift();){if(!f.hasOwnProperty(e))return!1;f=f[e]}return!0},l.defineDeep=function(b,c,d,e){a.isArray(c)||(c=(c+"").split(e||"."));for(var f,g=b,h=c.pop();f=c.shift();)g.hasOwnProperty(f)||(g[f]={}),g=g[f];g[h]=d},l.getDeep=function(b,c,d,e){a.isArray(c)||(c=(c+"").split(e||"."));for(var f,g=b,h=!0;f=c.shift();){if(!g.hasOwnProperty(f)){h=!1;break}g=g[f]}return h?g:d},l.updateDeep=function(b,c,d){if(!l.hasDeep(b,c))throw new Error("Update undefined deep");var e=a.M.getDeep(b,c);l.defineDeep(b,c,d(e))},l.appendDeep=function(b,c,d){l.updateDeep(b,c,function(b){return l.isLikeString(b)?b+=d+"":a.isArray(b)?b.push(d):b=[b,d],b})},l.minMax=function(a,b,c){return Math.max(b,Math.min(a,c))},l.randomString=function(b,c){var d,e,f="";for(!a.isUndefined(c)&&c.toString().length||(c="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),d=c.length,b=l.beNumber(b,10),e=b;e>0;--e)f+=c[Math.round(Math.random()*(d-1))];return f},l.randomInteger=function(a,b){0==arguments.length?(a=0,b=10):1==arguments.length&&(b=0);var c=b;return b=Math.max(Math.floor(a),Math.floor(b)),a=Math.min(Math.floor(c),Math.floor(a)),Math.floor(Math.random()*(b-a+1))+a},l.setup=function(b,c,d){switch(a.isObject(b)||(b={}),arguments.length){case 2:a.isObject(c)&&(b=a.extend({},b,c));break;case 3:b[c]=d}return b},l.validKeys=function(a,b){var c=[];b=l.beArray(b);for(var d=0,e=b.length;e>d;d++)a.hasOwnProperty(b[d])&&c.push(b[d]);return c},l.firstNotEmpty=function(){var b=a.flatten(a.toArray(arguments));return a.find(b,function(b){if(a.isString(b))return b.trim().length>0;if(l.isNumeric(b)){var c=parseFloat(b);return 0!==c&&!a.isNaN(c)&&a.isFinite(c)}return b===!0?!0:!a.isEmpty(b)})},l.pairsAsObject=function(b){var c=[];return a.each(b,function(a,b){c.push({key:b,value:a})}),c},l.pluckBy=function(b,c,d){var e={};return a.each(b,function(a){var b=a.hasOwnProperty(c)?a[c]:void 0,f=a.hasOwnProperty(d)?a[d]:void 0;e[b]=f}),e},l.invertToArray=function(b){var c={};return a.each(b,function(a,b){c.hasOwnProperty(a)?c[a].push(b):c[a]=[b]}),c},l.repeat=function(a,b,c){var d=[];b=Math.max(0,b);for(var e=0;b>e;e++)d.push(a);return c?d:d.join("")},l.span=function(b,c,d,e){return a.isUndefined(e)&&(e=!0),b+="",b.length<c&&(d=l.repeat((d+"").charAt(0),c-b.length),b=e?d+""+b:b+""+d),b},l.left=function(b,c){return a.isUndefined(c)&&(c=1),1>c?"":b.toString().substr(0,c)},l.right=function(b,c){var d=b.toString();return a.isUndefined(c)&&(c=1),1>c?"":d.substr(Math.max(0,d.length-c),c)},l.padNumber=function(a,b,c,d){var e=Math.abs(a).toString(d||10);return e=l.repeat("0",b-e.replace(/\.\d+/,"").length)+e,(c||0>a)&&(e=(0>a?"-":"+")+e),e},l.isNumeric=function(b){return!a.isArray(b)&&b-parseFloat(b)+1>=0},l.isInteger=function(a){return l.isNumeric(a)&&a%1===0},l.isMultiple=function(a,b){try{return a%b===0}catch(c){return!1}},l.isOdd=function(a){return l.isMultiple(a,2)},l.isEven=function(a){return!l.isMultiple(a,2)},l.oneOf=function(b,c,d){return-1!==c.indexOf(b)?b:arguments.length>=3?d:a.first(c)},l.capitalize=function(b,c){return c=a.isUndefined(c)?!0:Boolean(c),b.replace(c?/(^|\s)[a-z]/g:/(^|\s)[a-z]/,function(a){return a.toUpperCase()})},l.isLikeString=function(b){return a.isString(b)||l.isNumeric(b)},l.reverseString=function(a){return a.split("").reverse().join("")},l.isBlank=function(a){return 0===String(a).trim().length},l.nowSecond=function(){return parseInt(Math.floor(a.now()/1e3))},l.escapeURL=function(a,b){return b?encodeURIComponent(a):encodeURI(a)},l.unescapeURL=function(a,b){return b?decodeURI(a):decodeURIComponent(a)},l.escapeHTML=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\//g,"&#x2f;").toString()},l.valueAt=function(b,c){l.isLikeString(b)&&(b=(b+"").split("")),a.isArray(b)||(b+="");var d=b.length;return c%=d,0>c&&(c+=d),b[c]},l.chunk=function(b,c){var d=a.groupBy(b,function(a,b){return Math.floor(b/c)});return a.toArray(d)},l.chunks=function(a,b){return l.chunk(a,Math.ceil(a.length/b))},l.toggle=function(b,c,d){if(c=a.uniq(l.beArray(c)),a.isUndefined(d)){var e=a.intersection(b,c),f=a.difference(c,b);b=a.union(a.difference(b,e),f)}else b=d?a.union(b,c):a.difference(b,c);return b},l.defineObject=function(b){var c={};return a.each(b,function(b,d){d=d.trim(),a.has(c,d)||Object.defineProperty(c,d,{enumerable:!a.isFunction(b),value:b})}),c},l.isDefinedConstant=function(b){return a.has(l,b.trim().toUpperCase())},l.defineConstant=function(b,c){var d={},e=[],f=l;return a.isObject(b)?d=b:d[b]=c,a.each(d,function(a,b){b=b.trim().toUpperCase(),l.isDefinedConstant(b)||(Object.defineProperty(f,b,{enumerable:!0,value:a}),e.push(b))}),e},l.inherit=function(b,c,d){var e=b.prototype=Object.create(c.prototype);e.constructor=b,(d||a.isUndefined(d))&&(e._super=c.prototype)},l.callFunc=function(b,c,d){if(c=arguments.length>=2?l.beArray(c):[],b){if(a.isString(b)){if(l.WAITER.has(b))return l.WAITER.run(b,c,d);if(a.has(window,b)&&a.isFunction(window[b]))return window[b].apply(d||window,c);throw new Error("Invalid callback!")}if(a.isFunction(b))return b.apply(d||null,c);if(a.isArray(b)){var e=[],f=arguments.callee;return a.each(b,function(a){e.push(f(a,c,d))}),e}}},l.async=function(b,c,d,e){return d=parseInt(d),a.isNaN(d)&&(d=1),setTimeout(function(){l.callFunc(b,c,e||null)},Math.max(1,d))},l.logArgs=function(){console.log.apply(console,m.apply(arguments))},l.logCb=function(a){return f.apply(null,["log"].concat(m.apply(arguments)))},l.warnArgs=function(){console.warn.apply(console,m.apply(arguments))},l.warnCb=function(a){return f.apply(null,["warn"].concat(m.apply(arguments)))},l.errorArgs=function(){console.error.apply(console,m.apply(arguments))},l.errorCb=function(a){return f.apply(null,["error"].concat(m.apply(arguments)))};var p={},q=!1;l.isDebugging=function(b){return q||a.isEmpty(b)?q:p.hasOwnProperty(b)&&p[b]},l.debugging=function(b){return a.isEmpty(b)?void(q=!0):void(p[b]=!0)},l.debugComplete=function(b){return a.isEmpty(b)?(q=!1,void(p={})):void delete p[b]},l.onDebugging=function(a,b){l.isDebugging(a)&&l.callFunc(b)},l.getDebugString=function(b,c){var d=[];return a.each(l.beArray(b),function(a){d.push(JSON.stringify(a))}),d.join(c||"\n")},l.optionalArgs=function(b,c,d){var e,f,g,h,i,j,k,m={},n=0;if(g=a.difference(c,Object.keys(d)),g.forEach(function(a){d[a]=!0}),j=c.map(function(a){return d[a]}),a.isEmpty(b))return m;if(b.length>=c.length)m=a.object(c,b.slice(0,c.length));else for(i=b.slice(0);e=i.shift();){if(h=l.contentType(e),k=!1,f=n,l.loop(j.slice(n),function(b,c){return function(d){return d===!0||c===d||a.isArray(d)&&-1!=d.indexOf(c)||a.isFunction(d)&&d(b)?(k=!0,"break"):void n++}}(e,h)),!k){m=a.object(c.slice(0,b.length),b);break}m[c[n++]]=e}return m},l.defineConstant({SORT_NUMBER:g,SORT_NUMBER_DESC:h,IS_EQUAL:j,IS_STRICT_EQUAL:i})}(_),function(a){var b={};a.M.FLAG=a.M.defineObject({has:function(c){return a.has(b,c)},flag:function(c,d){d=a.isUndefined(d)?!0:Boolean(d),a.isArray(c)?a.each(c,function(a){b[a]=d}):b[c]=d},flags:function(c){return c?a.clone(b):a.keys(b)},get:function(a){return this.has(a)&&Boolean(b[a])},isFlagged:function(b){var c,d=this;return a.isArray(b)?(c=[],a.each(b,function(a){d.get(a)&&c.push(a)})):c=this.get(b),c},toggle:function(b,c){var d=arguments.callee,e=this;a.isArray(b)?a.each(b,function(a){d.apply(e,[a,c])}):a.isUndefined(c)?this.flag(b,!this.isFlagged(b)):this.flag(b,Boolean(c))},reset:function(){b={}}})}(_),function(a){function b(){this.type_prefix||(this.type_prefix=a.M.className(this,!0)),this.id||(this.id=a.M.nextID(this.type_prefix,!0))}a.M.BaseClass=b}(_),function(a){function b(b,d,e,f){if(c.hasOwnProperty(d))throw new Error("Destination Pre Options is already exists");b=a.M.beArray(b);var g=a.filter(b,function(a){return!c.hasOwnProperty(a)});if(!a.isEmpty(g))throw new Error("PreOptions are not defined:"+g.join(", "));if(a.isObject(e)||(e={}),f)c[d]={options:e,base:b};else{var h={};a.each(b,function(b){a.extend(h,a.M.PreOptions.get(b))}),a.extend(e,h),c[d]={options:e,base:[]}}}var c={};a.M.PreOptions=a.M.defineObject({define:function(a,b,d){return d||!c.hasOwnProperty(a)?(c[a]={options:b,base:[]},!0):!1},has:function(a){return c.hasOwnProperty(a)},update:function(b,d){return c.hasOwnProperty(b)?(a.extend(c[b].options,d),!0):!1},updateBase:function(a,b){return c.hasOwnProperty(a)?(c[a].base=b,!0):!1},get:function(b,d){if(!c.hasOwnProperty(b))throw new Error('Pre Options "'+b+'" is undefined');var e={};return a.each(a.M.beArray(c[b].base),function(b){a.extend(e,a.M.PreOptions.get(b))}),a.extend(e,a.clone(c[b].options),a.isObject(d)?d:{}),e},extend:function(a,c,d){b(a,c,d,!0)},baseOn:function(a,c,d){b(a,c,d,!1)},list:function(b){return b?a.clone(c):Object.keys(c)},reset:function(){c={}}})}(_),function(a){function b(a,b){var c=b.substr(a.id.length+1).split("_");return c.length>1?c[0]:!1}function c(){a.M.BaseClass.call(this),this._contents={},this._usings={}}a.M.defineConstant({CONTENT_TYPE_STRING:"string",CONTENT_TYPE_NUMBER:"number",CONTENT_TYPE_BOOLEAN:"boolean",CONTENT_TYPE_ARRAY:"array",CONTENT_TYPE_FUNCTION:"function",CONTENT_TYPE_OBJECT:"object",CONTENT_TYPE_MIXED:"mixed"}),a.M.inherit(c,a.M.BaseClass),c.prototype.hasType=function(a){return this._contents.hasOwnProperty(a)},c.prototype.types=function(){return Object.keys(this._contents)},c.prototype.keys=function(){var a=this,b={};return Object.keys(this._contents).forEach(function(c){b[c]=Object.keys(a._contents[c])}),b},c.prototype.filter=function(b,c){var d=[],e=this;return c=a.isUndefined(c)?Object.keys(this._contents):a.intersection(a.M.beArray(c),Object.keys(this._contents)),a.M.loop(c,function(c){a.M.loop(Object.keys(e._contents[c]),function(f){b(e._contents[c][f].content,e._contents[c][f].meta,f,c)&&d.push({type:c,key:f,content:a.clone(e._contents[c][f].content),meta:e._contents[c][f].meta?a.clone(e._contents[c][f].meta):void 0})})}),d},c.prototype.find=function(b,c){var d=!1,e=this;return c=a.isUndefined(c)?Object.keys(this._contents):a.intersection(a.M.beArray(c),Object.keys(this._contents)),a.M.loop(c,function(c){return a.M.loop(Object.keys(e._contents[c]),function(f){var g=e._contents[c][f];return b(a.clone(g.content),a.clone(g.meta),f,c)?(d={type:c,key:f,content:a.clone(g.content),meta:g.meta?a.clone(g.meta):void 0},"break"):void 0}),d?"break":void 0}),d},c.prototype.contentPositions=function(a,b){var c=function(b){return a===b};return this.filter(c,b)},c.prototype.isValidKey=function(a){return!1!==b(this,a)},c.prototype.hasContent=function(a,b){var c=function(b){return a===b};return!1!==this.find(c,b)},c.prototype.has=function(a){if(this.isUsing(a))return!0;var c=b(this,a);return!1!==c?this._contents.hasOwnProperty(c)&&this._contents[c].hasOwnProperty(a):!1},c.prototype.clean=function(){var b=this;a.each(Object.keys(this._contents),function(c){a.isEmpty(b._contents[c])&&delete b._contents[c]})},c.prototype.add=function(b,c,d){d||(d=a.M.contentType(b));var e=a.M.nextID(this.id+"_"+d);return this._contents.hasOwnProperty(d)||(this._contents[d]={}),this._contents[d][e]={content:b,meta:c},e},c.prototype.addUnique=function(b,c,d){d||(d=a.M.contentType(b));var e=this.contentPositions(b,d);return 0==e.length?this.add(b,c,d):e.shift().key},c.prototype.items=function(c,d){var e,f,g,h={};if(g=d?function(b){return a.clone(b)}:function(b){return a.clone(b.content)},a.isEmpty(c)){for(e in this._contents)if(this._contents.hasOwnProperty(e))for(f in this._contents[e])this._contents[e].hasOwnProperty(f)&&(h[f]=g(this._contents[e][f]))}else{var i=a.groupBy(a.M.beArray(c),a.partial(b,this));for(e in i)i.hasOwnProperty(e)&&a.each(a.pick(this._contents[e],i[e]),function(a,b){h[b]=g(a)})}return h},c.prototype.isUsing=function(a){return this._usings.hasOwnProperty(a)},c.prototype.isUsingContent=function(b,c){var d=this.contentPositions(b,c);return a.isEmpty(d)?!1:!a.isEmpty(a.intersection(a.pluck(d,"key"),Object.keys(this._usings)))},c.prototype.using=function(b,c){return this.has(b)?(a.isUndefined(c)||c?this._usings[b]=!0:delete this._usings[b],!0):!1},c.prototype.unused=function(b){this._usings=a.omit(this._usings,a.flatten(a.toArray(arguments)))},c.prototype.usingKeys=function(c){return c?a.groupBy(Object.keys(this._usings),a.partial(b,this)):Object.keys(this._usings)},c.prototype.unusedKeys=function(b){var c=this.usingKeys(!0),d={};for(var e in this._contents)this._contents.hasOwnProperty(e)&&(c.hasOwnProperty(e)?d[e]=a.difference(Object.keys(this._contents[e]),c[e]):d[e]=Object.keys(this._contents[e]),a.isEmpty(d[e])&&delete d[e]);return b?d:a.flatten(a.values(d))},c.prototype.get=function(c){var d=b(this,c);return!1!==d&&this._contents[d].hasOwnProperty(c)?a.clone(this._contents[d][c]):!1},c.prototype.getType=function(b){return this.hasType(b)?a.clone(this._contents[b]):!1},c.prototype.getContent=function(b,c){var d=this.get(b);return!1!==d?a.clone(d.content):c},c.prototype.getMeta=function(b,c){var d=this.get(b);return!1!==d?a.clone(d.meta):c},c.prototype.remove=function(c){var d=[],e=a.groupBy(a.flatten(a.toArray(arguments)),a.partial(b,this));delete e["false"];for(var f in e)if(e.hasOwnProperty(f)&&this._contents.hasOwnProperty(f))for(var g in e[f])e[f].hasOwnProperty(g)&&(d.push({type:f,key:e[f][g]}),delete this._contents[f][e[f][g]],delete this._usings[e[f][g]]);return this.clean(),d},c.prototype.removeContent=function(b,c){var d=this.contentPositions(b,c),e=this;return d.length&&a.each(d,function(a){delete e._contents[a.type][a.key],delete e._usings[a.key]}),this.clean(),d},c.prototype.update=function(a,c,d){if(this.has(a)){var e=b(this,a);return this._contents[e][a].content=c,arguments.length>=3&&(this._contents[e][a].meta=d),!0}return!1},c.prototype.updateMeta=function(a,c){if(this.has(a)){var d=b(this,a);return this._contents[d][a].meta=c,!0}return!1},c.prototype.removeUsing=function(){return this.remove(Object.keys(this._usings))},c.prototype.removeUnusing=function(){return this.remove(this.unusedKeys())},c.prototype.status=function(){return{using:Object.keys(this._usings),types:this.keys()}},a.M.ContentManager=c}(_),function(a){function b(){a.M.ContentManager.call(this),this._priorities={},this._key_mapped={}}function c(b,c,e){var f=a.M.invertToArray(a.pick(b._key_mapped,a.M.beArray(c))),g=a.M.castItemsType(Object.keys(f),"number");return e=e?a.intersection(a.M.castItemsType(a.M.beArray(e),"number"),g):g,e=d(b,e),a.mapObject(a.pick(b._priorities,e),function(b,c){return a.intersection(f[c],b)})}function d(b,c){return a.intersection(a.M.castItemsType(c,"number"),a.M.castItemsType(Object.keys(b._priorities),"number"))}function e(b,d,e){var f,g=c(b,d,e);return a.M.loop(g,function(c,d){b._priorities[d]=a.difference(b._priorities[d],c)}),f=a.flatten(a.values(g)),a.M.removeKeys(b._key_mapped,f),f}a.M.defineConstant({PRIORITY_HIGHEST:100,PRIORITY_HIGH:250,PRIORITY_DEFAULT:500,PRIORITY_LOW:750,PRIORITY_LOWEST:1e3,PRIORITY_LEVEL_1:100,PRIORITY_LEVEL_2:200,PRIORITY_LEVEL_3:300,PRIORITY_LEVEL_4:400,PRIORITY_LEVEL_5:500,PRIORITY_LEVEL_6:600,PRIORITY_LEVEL_7:700,PRIORITY_LEVEL_8:800,PRIORITY_LEVEL_9:900,PRIORITY_LEVEL_10:1e3}),a.M.inherit(b,a.M.ContentManager),b.prototype.hasPriority=function(a){return this._priorities.hasOwnProperty(a)},b.prototype.has=function(a){return this._key_mapped.hasOwnProperty(a)},b.prototype.status=function(){var a=Object.keys(this._priorities),b={priorities:a.length,contents:0},c=this;return a.forEach(function(a){b.contents+=c._priorities[a].length}),b},b.prototype.add=function(b,c,d){var e=this._super.add.call(this,b,d,"priority");return this.using(e),c=a.M.beNumber(c,a.M.PRIORITY_DEFAULT),a.has(this._priorities,c)||(this._priorities[c]=[]),this._priorities[c].push(e),this._key_mapped[e]=c,e},b.prototype.remove=function(b,c){var d=e.apply(null,[this].concat(a.toArray(arguments)));return a.pluck(this._super.remove.call(this,d),"key")},b.prototype.removeContent=function(b,c){var d=this.contentPositions(b,"priority"),e=a.pluck(d,"key");return e.length?c?this.remove(e,c):this.remove(e):[]},b.prototype["export"]=function(b){var c=[],d=a.M.castItemsType(Object.keys(this._priorities),"number"),e=this,f=this.getType("priority");return d.sort(a.M.SORT_NUMBER),a.each(d,function(d){a.each(e._priorities[d],function(d){f.hasOwnProperty(d)&&(b?c.push(f[d].content):c.push(a.extend({key:d},f[d])))})}),c},a.M.Priority=b}(_),function(a){var b={};a.M.WAITER=a.M.defineObject({has:function(a){return b.hasOwnProperty(a)&&b[a].times>0},add:function(c,d,e){var f=a.M.nextID("waiter_key",!0);return b[f]={callback:c,times:a.isUndefined(d)?1:d,description:e||""},f},createFunc:function(b,c,d){var e=this.add(b,c,d),f=this;return window[e]=function(b){return function(){return f.run.apply(f,[b].concat(a.toArray(arguments)))}}(e),e},remove:function(){var c=a.flatten(a.toArray(arguments)),d=[];return a.each(c,function(a){b.hasOwnProperty(a)&&(d.push(a),window[a]=void 0,delete b[a],delete window[a])}),d},run:function(c,d,e){var f;if(!this.has(c))throw new Error("Waiter key is non-exists: "+c);return f=b[c].callback.apply(e||null,a.M.beArray(d)),--b[c].times<1&&this.remove(c),f},list:function(c){if(c){var d={};return a.each(b,function(a,b){d[b]=a.description}),d}return Object.keys(b)}})}(_),function(a){function b(b){a.M.BaseClass.call(this),b=a.defaults(b||{},{limit:a.M.EVENT_EMITTER_EVENT_LIMIT_LISTENERS,events:{},event_mimics:[],event_privates:[]}),this._events={},this._event_emitted={},this._limit=a.M.beNumber(b.limit,a.M.EVENT_EMITTER_EVENT_LIMIT_LISTENERS),this._event_followers={},this._event_following={},this._event_mimics=[],this._event_privates=["attach","attached"],a.isEmpty(b.events)||this.addListeners(a.M.beObject(b.events)),a.isEmpty(b.event_mimics)||this.mimic(a.M.beArray(b.event_mimics)),a.isEmpty(b.event_privates)||this["private"](a.M.beArray(b.event_privates))}function c(b,c,d){a.each(c,function(c){if(b._events.hasOwnProperty(c)){if(b._limit!=a.M.EVENT_EMITTER_EVENT_UNLIMITED){var e=b._events[c].priority.status();e.contents+d>b._limit&&console.warn("Possible _.M.EventEmitter memory leak detected. "+(e.contents+listeners.length)+" listeners added (limit is "+b._limit+"). Use emitter.limit() or emitter.unlimited to resolve this warning.")}}else b._events[c]={priority:new a.M.Priority,key_mapped:{}}})}function d(b){return a.M.isNumeric(b)&&(b={priority:b}),b=a.defaults(b||{},{priority:a.M.PRIORITY_DEFAULT,times:-1,context:null,key:null,async:!1}),b.times=a.M.beNumber(b.times,-1),null===b.key&&(b.key=a.M.nextID("event_emitter_listener")),b}function e(b,c,d,e){var f=[],g=b._events[c];return a.M.loop(a.M.beArray(d),function(a){var b=g.priority.add(a,e.priority,{listener_key:e.key,async:e.async,times:e.times,event:c});f.push(b)}),f}function f(b,c,d){var e,f=!1;return b._events.hasOwnProperty(c)&&(e=b._events[c].priority["export"](),e.length&&(f=!0,a.each(e,function(e){if(-1==e.meta.times||e.meta.times>0){if(e.meta.async?a.M.async(e.content,d,e.meta.context||b):a.M.callFunc(e.content,d,e.meta.context||b),-1==e.meta.times)return;if(e.meta.times--,e.meta.times>0)return void b._events[c].priority.updateMeta(e.key,e.meta)}g(b,c,e.meta.listener_key,e.key)}))),b._event_emitted.hasOwnProperty(c)?b._event_emitted[c]+=1:b._event_emitted[c]=1,f}function g(b,c,d,e){b._events.hasOwnProperty(c)&&b._events[c].key_mapped.hasOwnProperty(d)&&(b._events[c].priority.remove(e),b._events[c].key_mapped[d]=a.without(b._events[c].key_mapped[d],e),b._events[c].key_mapped[d].length||delete b._events[c].key_mapped[d])}function h(b,c){return"event_emitted"!==c&&-1==b._event_privates.indexOf(c)&&!a.isEmpty(b._event_followers)}function i(b,c,d){a.each(b._event_followers,function(e){e.async?a.M.async(a.partial(j,e),[b.id,c,d],b):a.M.callFunc(a.partial(j,e),[b.id,c,d],b)})}function j(a,b,c,d){a.target.notice(b,c,d)}function k(b,c){return c?a.M.validKeys(b._events,a.M.beArray(c)):Object.keys(b._events)}function l(b,c,d){for(var e,f,g={},h=a.clone(d);c.length&&(e=h.shift());)f=a.M.validKeys(b._events[e].key_mapped,c),f.length&&(g[e]=f,c=a.difference(c,f));return g}function m(b,c,d,e){var f,g=l(b,c,d);return a.each(g,function(c,d){f=b._events[d],f.priority.remove(a.flatten(a.values(a.pick(f.key_mapped,c))),e?e:null),a.M.removeKeys(f.key_mapped,c),b._events[d]=f}),g}function n(b,c,d,e){var f,g={};return e=e||null,a.each(c,function(c){a.each(d,function(d){if(f=b._events[d].priority.removeContent(c,e),f.length){var h=o(b._events[d].key_mapped,f);p(g,a.M.beObject(d,Object.keys(h)))}})}),g}function o(b,c){for(var d,e,f=Object.keys(b),g={};c.length&&(e=f.shift());)d=a.intersection(c,b[e]),d.length&&(b[e]=a.difference(b[e],d),b[e].length||delete b[e],c=a.difference(c,d),g[e]=d);return g}function p(b,c){a.each(c,function(c,d){c=a.M.beArray(c),b.hasOwnProperty(d)?a.M.mergeArray(b[d],c):b[d]=c})}a.M.defineConstant({EVENT_EMITTER_EVENT_LIMIT_LISTENERS:10,EVENT_EMITTER_EVENT_UNLIMITED:-1}),a.M.inherit(b,a.M.BaseClass),b.prototype.resetEvents=function(a){a?this._events.hasOwnProperty(a)&&(delete this._events[a],delete this._event_emitted[a]):(this._events={},this._event_emitted={})},b.prototype.reset=function(a){return this.resetEvents(a)},b.prototype.events=function(a){if(a){var b={},c=this;return Object.keys(this._events).forEach(function(a){b[a]=c._events[a].priority.status().contents}),b}return Object.keys(this._events)},b.prototype.emitted=function(b){return a.isUndefined(b)?a.clone(this._event_emitted):this._event_emitted.hasOwnProperty(b)?this._event_emitted[b]:0},b.prototype.limit=function(a){this._limit=a+0},b.prototype.unlimited=function(){this._limit=a.M.EVENT_EMITTER_EVENT_UNLIMITED},b.prototype.addListener=function(b,f,g){var h=this;return f=a.M.beArray(f),b=a.uniq(a.M.beArray(b)),f.length?(c(this,b,f.length),g=d(g),a.each(b,function(b){var c=h._events[b],d=e(h,b,f,g);c.key_mapped.hasOwnProperty(g.key)?a.M.mergeArray(c.key_mapped[g.key],d):c.key_mapped[g.key]=d}),g.key):!1},b.prototype.has=function(b,c){if(c=c?a.intersection(a.M.beArray(b),Object.keys(this._events)):Object.keys(this._events),a.isEmpty(c))return!1;var d=!1,e=this;return a.M.loop(c,function(a){return e._events[a].key_mapped.hasOwnProperty(b)?(d=!0,"break"):void 0}),d},b.prototype.on=function(a,b,c){return this.addListener.apply(this,arguments)},b.prototype.addOnceListener=function(b,c,d){return a.M.isNumeric(d)?d={priority:d,times:1}:a.isObject(d)||(d={times:1}),this.addListener(b,c,d)},b.prototype.once=function(a,b,c){return this.addOnceListener.apply(this,arguments)},b.prototype.addListeners=function(b){var c=[],d=this,e=[];return a.isObject(b)&&a.each(b,function(b,d){b=a.M.beArray(b),a.each(b,function(b){b=a.M.beArray(b),c.push({name:d,cb:b[0],options:b.length>1?b[1]:{}})})}),a.each(c,function(a){e.push(d.addListener(a.name,a.cb,a.options))}),e},b.prototype.emitEvent=function(b,c,d){var e=this;a.each(a.M.beArray(b),function(b){e._events.hasOwnProperty(b)&&f(e,b,a.clone(c)),"event_emitted"!==b&&f(e,"event_emitted",[b,a.clone(c)]),h(e,b)&&i(e,b,a.clone(c)),f(e,b+"_complete",a.clone(c))}),d&&d.call(this)},b.prototype.emit=function(){this.emitEvent.apply(this,arguments)},b.prototype.removeListener=function(b,c,d){var e,f,g=this,h={};return b=a.M.beArray(b),c=k(g,c),e=a.filter(b,a.M.isLikeString),f=a.filter(b,a.isFunction),e.length&&(h=m(g,e,c,d)),f.length&&p(h,n(g,f,c,d)),a.each(c,function(b){a.isEmpty(g._events[b].key_mapped)&&delete g._events[b]}),h},b.prototype.off=function(){return this.removeListener.apply(this,arguments)},b.prototype["private"]=function(){a.M.mergeArray(this._event_privates,a.flatten(a.toArray(arguments)))},b.prototype.mimic=function(){a.M.mergeArray(this._event_mimics,a.flatten(a.toArray(arguments)))},b.prototype.attach=function(b,c,d,e){if(a.M.isEventEmitter(b))return this._event_followers.hasOwnProperty(b.id)?!1:(this._event_followers[b.id]={target:b,async:a.isUndefined(e)||Boolean(e)},this.emitEvent("attach",[b,c,d]),b.attachTo(this,c,d),!0);throw new Error("Invalid _.M.EventEmitter instance")},b.prototype.hasFollower=function(b){return a.M.isEventEmitter(b)&&this._event_followers.hasOwnProperty(b.id)},b.prototype.attachHard=function(a,b,c){return this.attach(a,b,c,!1)},b.prototype.attachTo=function(b,c,d,e){if(!a.M.isEventEmitter(b))throw new Error("Invalid _.M.EventEmitter instance");return this._event_following.hasOwnProperty(b.id)?!0:(this._event_following[b.id]={id:b.id,type:b.type_prefix,only:a.M.beArray(c||[]),excepts:a.M.beArray(d||[])},this.emitEvent("attached",[b,c,d]),e?b.attachHard(this):b.attach(this))},b.prototype.isFollowing=function(b){return a.M.isEventEmitter(b)&&this._event_following.hasOwnProperty(b.id)},b.prototype.attachHardTo=function(a,b,c){return this.attachTo(a,b,c,!0)},b.prototype.notice=function(b,c,d){if(this._event_following.hasOwnProperty(b)){var e=this._event_following[b],f=this;if((a.isEmpty(e.only)||-1!==e.only.indexOf(c))&&(a.isEmpty(e.excepts)||-1===e.excepts.indexOf(c))){var g=[c,e.type+".*",e.type+"."+c];if(!a.isEmpty(a.intersection(g,f._event_mimics)))return void f.emitEvent(c,d);var h={id:e.id,type:e.type,event:c,data:d},i=[e.id+"."+c,e.type+"."+c,"noticed."+e.id+"."+c,"noticed."+e.id,"noticed."+e.type+"."+c,"noticed."+e.type,"noticed"];this.emitEvent(i,h)}}},b.prototype.detach=function(b){if(a.M.isEventEmitter(b))return this._event_followers.hasOwnProperty(b.id)?(this.emitEvent("detach",[b]),delete this._event_followers[b.id],b.detachFrom(this),!0):!1;throw new Error("Invalid _.M.EventEmitter instance")},b.prototype.detachFrom=function(b){if(a.M.isEventEmitter(b))return this._event_following.hasOwnProperty(b.id)?(this.emitEvent("detached",[b]),delete this._event_following[b.id],b.detach(this),!0):!1;throw new Error("Invalid _.M.EventEmitter instance")},a.M.EventEmitter=b,a.M.isEventEmitter=function(c){return a.isObject(c)?c instanceof b:!1}}(_),function(a){function b(b){if(a.has(i,b)){if(i[b].expire_time===!0||i[b].expire_time-1>a.M.nowSecond())return!0;d(b)}return!1}function c(b,c,d){!a.isUndefined(d)&&a.M.isNumeric(Number(d))||(d=a.M.CACHE_MEDIUM),i[b]={value:c,live_time:d,expire_time:d===!0?!0:a.M.nowSecond()+d}}function d(){a.each(a.flatten(arguments),function(a){delete i[a]})}function e(d,e,f){var g=a.M.CACHE_MEDIUM,h=[];if(a.isUndefined(f)&&(f=!0),b(d)){var j=i[d];if(g=j.live_time,h=j.value,a.isArray(h)||(h=[h]),f)h.push(e);else{var k=a.lastIndexOf(h,e);-1!=k&&h.splice(k,1)}}else{if(!f)return;h.push(e)}return c(d,h,g),i[d].value}function f(d,e,f){return!a.isUndefined(e)&&a.M.isNumeric(Number(e))||(e=1),a.isUndefined(f)&&(f=!0),e=f?Math.abs(e):-1*Math.abs(e),b(d)?(i[d].value=Number(i[d].value),a.M.isNumeric(i[d].value)||(i[d].value=0),i[d].value+=e):c(d,e),i[d].value}function g(){var b=[],c=a.M.nowSecond();a.each(i,function(a,d){a.expire_time!==!0&&a.expire_time<=c&&b.push(d)}),d(b)}a.M.defineConstant({CACHE_MIN:10,CACHE_TINY:60,CACHE_SHORT:300,CACHE_MEDIUM:600,CACHE_LONG:3600,CACHE_FOREVER:!0});var h,i={},j=a.M.CACHE_MIN;h=setInterval(g,1e3*j),a.M.CACHE=a.M.defineObject({set:function(a,b,d){c(a,b,d)},has:function(a){return b(a)},get:function(b,c){if(a.has(i,b)){if(i[b].expire_time===!0||i[b].expire_time>a.M.nowSecond())return i[b].value;delete i[b]}return c},touch:function(b,c){if(this.has(b)){if(i[b].expire_time!==!0){var d=i[b];return a.M.isNumeric(c)||(c=d.live_time),d.expire_time=Math.max(d.expire_time,a.M.nowSecond()+c),d.expire_time}return!0}return!1},list:function(b){var c,d,e=a.M.nowSecond();return b||a.isUndefined(b)?(c=[],d=function(a){c.push(a)}):(c={},d=function(a,b){c[a]=b}),a.each(i,function(a,b){(a.expire_time===!0||e<a.expire_time)&&d(b,a)}),c},clean:function(){return g()},expire:function(){d(Array.prototype.slice.apply(arguments))},increment:function(b,c){return a.M.isNumeric(c)||(c=1),f(b,c,!0)},decrement:function(b,c){return a.M.isNumeric(c)||(c=1),f(b,c,!1)},arrayPush:function(a,b){return e(a,b,!0)},arrayWithout:function(a,b){return e(a,b,!1)}})}(_),function(a){function b(b){this.type_prefix="Task",a.M.BaseClass.call(this),this.name="",this.options={},this.handler=b||null,this._result=null,this._error=null}function c(a,b,c){try{b.bind(a)(c,a.setProcessResult.bind(a),a.setProcessError.bind(a))}catch(d){a.setProcessError(d.message||d.description,d.number||0)}}function d(a,b,c){b.process(c),a._result=c.getResult(),a._error=c.getError()}var e={};b.prototype.option=function(b,c){return this.options=a.M.setup.apply(a.M,[this.options].concat(a.M.sliceArguments(arguments))),
this},b.prototype.isError=function(){return!a.isNull(this._error)},b.prototype.getError=function(){return this.isError()?a.pick(a.extend({code:0,message:""},a.isObject(this._error)?this._error:{}),"code","message"):null},b.prototype.getResult=function(){return this._result},b.prototype.setProcessResult=function(a){this._result=a,this._error=null},b.prototype.setProcessError=function(a,b){this._result=null,this._error={message:a,code:b||0}},b.prototype.process=function(e){var f=this;return this._result=a.clone(e),this._error=null,a.isString(this.handler)&&(this.handler=a.M.beArray(this.handler)),a.isFunction(this.handler)?c(this,this.handler,e):this.handler instanceof b?d(this,this.handler,f._result):a.isArray(this.handler)?a.M.loop(this.handler,function(c){var e;return e=a.isString(c)?b.factory(c):new b(c),d(f,e,f._result),f.isError()?"break":void 0}):a.isObject(this.handler)&&a.M.loop(this.handler,function(c,e){var g=b.factory(e);return a.isEmpty(c)||g.options(c),d(f,g,f._result),f.isError()?"break":void 0}),!this.isError()},b.isRegistered=function(a){return e.hasOwnProperty(a)},b.list=function(){return Object.keys(e)},b.register=function(c,d,f){var g=a.M.optionalArgs(a.M.sliceArguments(arguments),["name","handler","options"],{name:"string",handler:["string","Function","Array","Task"],options:"Object"});g.handler instanceof b&&(g.name=g.handler.name),e[g.name]={handler:g.handler,options:g.options}},b.factory=function(c,d){if(b.isRegistered(c)){var f=e[c],g=new b;return g.name=c,g.handler=f.handler,g.options=f.options,a.isObject(d)&&g.option(d),g}throw new Error("Create an unregistered task: "+c)},b.apply=function(c,d){var e={data:a.clone(c)};return d&&(a.isString(d)&&(d=[d]),a.isArray(d)&&(d=a.object(d,a.M.repeat({},d.length,!0))),a.M.loop(d,function(c,d){var f=b.factory(d,c);return f.process(a.clone(e.data))?void(e.data=f.getResult()):(delete e.data,e.error=f.getError(),"break")})),e},a.M.Task=b}.call(window,_),function(a){function b(){a.M.EventEmitter.call(this),this["private"]("init")}a.M.inherit(b,a.M.EventEmitter),b.prototype.option=function(b,c,d){var e,f={};if(a.isObject(b))f=b,e=a.pick(f,function(b,c){return"_"===(c+"")[0]||a.isFunction(b)}),a.isEmpty(e)||console.warn("Invalid _.App options: "+Object.keys(e).join(", ")),a.extend(this,a.omit(b,Object.keys(e)));else{b+="";var g=b.split(d||".");if("_"===g[0][0])return console.warn("Invalid _.App options: "+g[0][0]),this;a.M.defineDeep(this,g,c)}return this},b.prototype.onInit=function(b,c,d){return this.addListener("init",b,{times:c||1,priority:d||a.M.PRIORITY_DEFAULT}),this},b.prototype.init=function(a){this.emitEvent("init"),a&&this.resetEvents("init")},b.prototype.resetInitCallbacks=function(){this.resetEvents("init")},a.module("App",new b)}(_),function(a){function b(b){a.M.EventEmitter.call(this),this.options=a.M.PreOptions.get(a.M.AJAX_PRE_OPTIONS_NAME),this.jqXHR=null,this.requested=0,this.retry_time=0,this._last_options=null,this._is_retrying=!1,this._retry_timeout_id=null,this.response=null,this.error=null,this._is_response_meaning_failed=!1,a.isObject(b)&&this.option(b)}function c(b){var c=a.M.Task.apply(b,this.options.response_tasks);return c.error?(this._is_response_meaning_failed=!0,this.error=c.error,void(this.isRetryable()||this.emitEvent("fail",[c.error.message,c.error.code]))):(this.response=c.data,void this.emitEvent("done",[a.clone(c.data)]))}function d(a,c,d){var e=b.beautifyError(arguments);this.error=e,this.isRetryable()||this.isAborted()||this.emitEvent("fail",[e.message,e.code])}function e(b){b._last_options=null,b._is_retrying=!1,b.emitEvent("always",[b.error,b.response]),a.App&&a.App.emitEvent("ajax_complete",[b])}function f(b,c){var d=this;if(this.isAborted())this.emitEvent("aborted");else if(this.isRetryable())return this.isRetrying()&&(this.emitEvent("retry_complete",[this.retry_time,this.isLastRetryTime(),b,c]),a.App&&a.App.emitEvent("ajax_retry_complete",[this,this.retry_time,this.isLastRetryTime(),b,c])),this._is_retrying=!0,void(this.options.retry_delay?this._retry_timeout_id=a.M.async(function(){d.request()},[],this.options.retry_delay):this.request());e(this)}function g(b,e){var g,h=a.extend({},b.options,a.isObject(e)?e:{});if((h.hasOwnProperty("success")||h.hasOwnProperty("done"))&&(b.removeListener("success_listeners_from_options"),b.addListener("done",a.values(a.pick(h,["success","done"])),{priority:a.M.PRIORITY_HIGHEST,key:"success_listeners_from_options"})),(h.hasOwnProperty("error")||h.hasOwnProperty("fail"))&&(b.removeListener("error_listeners_from_options"),b.addListener("fail",a.values(a.pick(h,["error","fail"])),{priority:a.M.PRIORITY_HIGHEST,key:"error_listeners_from_options"})),(h.hasOwnProperty("complete")||h.hasOwnProperty("always"))&&(b.removeListener("complete_listeners_from_options"),b.addListener("always",a.values(a.pick(h,["complete","always"])),{priority:a.M.PRIORITY_HIGHEST,key:"complete_listeners_from_options"})),h.hasOwnProperty("beforeSend")&&(g=h.beforeSend),a.M.removeKeys(h,["success","done","error","fail","complete","always","beforeSend"]),h.done=c.bind(b),h.fail=d.bind(b),h.always=f.bind(b),h.beforeSend=function(c,d){var e=!0;return b.option("auto_abort")&&b.isRequesting()&&b.abort(),a.isFunction(g)&&!b.isRetrying()&&(e=a.M.callFunc(g,[c,d],b)),a.isObject(h.data)||(h.data={}),!1!==e&&(b.requested++,b.error=null,b._is_response_meaning_failed=!1,b.response=null,b.responses=null,b.isRetrying()?(b.retry_time++,b.emitEvent("retry")):(b.retry_time=0,b.emitEvent("request"))),e},!a.isEmpty(h.data_tasks)){var i=a.M.Task.apply(a.clone(h.data),h.data_tasks);if(!i.data)return this.error=i.error,!1;h.data=i.data}return a.M.removeKeys(h,["response_tasks","data_tasks","auto_abort","retry","retry_delay","is_continue"]),h}function h(b,c){var d;return(1==arguments.length||b.isRetrying())&&a.isObject(b._last_options)?d=b._last_options:(d=g(b,c),!1!==d?b._last_options=d:(b.emitEvent("fail",[b.error.message,b.error.code]),e(b))),d&&(b.jqXHR=$.ajax(a.omit(d,["done","fail","always"])).done(d.done).fail(d.fail).always(d.always)),b}function i(b,c,d,e,f,g){var i,j={url:d,method:(c+"").toUpperCase()};return i=a.M.optionalArgs(Array.prototype.slice.call(arguments,3),["data","callback","dataType"],{data:["string","Object"],callback:"Function",dataType:"string"}),i.data&&(j.data=i.data),i.callback&&(j.done=i.callback),i.dataType&&(j.dataType=i.dataType),h(b,j)}function j(a,b,c){switch(b=$(b),c){case"append":b.append(a);break;case"prepend":b.prepend(a);break;default:b.html(a)}}a.M.defineConstant({AJAX_PRE_OPTIONS_NAME:"_.M.AJAX",AJAX_ABORTED:"aborted",AJAX_TIMEOUT:"timeout",AJAX_PARSER_ERROR:"parser_error",AJAX_SERVER_ERROR:500,AJAX_FORBIDDEN:403,AJAX_NOT_FOUND:404});var k={204:"Server has received the request but there is no information to send back",400:"The request had bad syntax or was inherently impossible to be satisfied",401:"The parameter to this message gives a specification of authorization schemes which are acceptable",403:"The request is for something forbidden",404:"The server has not found anything matching the URI given",405:"Method not allowed",406:"Not acceptable",408:"Request timeout",413:"Payload too large",414:"URI too long",429:"Too many requests",431:"Request header fields too large",500:"The server encountered an unexpected condition which prevented it from fulfilling the request",501:"The server does not support the facility required",parser_error:"Parse response failed",aborted:"Manual abort request"};a.M.PreOptions.define(a.M.AJAX_PRE_OPTIONS_NAME,{response_tasks:{},data_tasks:{},auto_abort:!0,retry:0,retry_delay:0,is_continue:!0}),a.M.inherit(b,a.M.EventEmitter),b.globalOption=function(b){a.M.PreOptions.update(a.M.AJAX_PRE_OPTIONS_NAME,b)},b.beautifyError=function(b){var c=b[0],d=b[1],e=b[2],f={code:"",message:"Ajax error"};switch(d){case"parsererror":f.code=a.M.AJAX_PARSER_ERROR;break;case"abort":f.code=a.M.AJAX_ABORTED;break;default:f.code=c.status}return k.hasOwnProperty(f.code)?f.message=k[f.code]:f.message=e,f},b.prototype.option=function(b,c){return this.options=a.M.setup.apply(a.M,[this.options].concat(Array.prototype.slice.apply(arguments))),this},b.prototype.data=function(a){return this.options.data=a,this},b.prototype.addData=function(b,c){var d;return this.options.data||(this.options.data={}),a.isObject(arguments[0])?d=a.extend({},b):(d={},arguments.length<2?d[b+""]="true":d[b]=c),a.isObject(this.options.data)?a.extend(this.options.data,d):a.isString(this.options.data)&&(d=a.map(d,function(a,b){return b+"="+a}),this.options.data.length?this.options.data+="&"+d:this.options.data=d),this},b.prototype.done=function(b){return this.on("done",b),this.isSuccess()&&b.apply(this,[a.clone(this.response)]),this},b.prototype.fail=function(a){return this.on("fail",a),this.isFailed()&&a.apply(this,[this.error.message,this.error.code]),this},b.prototype.always=function(a){return this.on("always",a),this.isDone()&&a.apply(this,[this.error,this.response]),this},b.prototype.status=function(){return a.isObject(this.jqXHR)&&this.jqXHR.hasOwnProperty("readyState")?this.jqXHR.readyState:!1},b.prototype.isReady=function(){var a=this.status();return a!==!1&&0===a},b.prototype.isRequesting=function(){var a=this.status();return a!==!1&&a>=1&&3>=a},b.prototype.isRetrying=function(){return Boolean(this._is_retrying)},b.prototype.isDone=function(){return!this.isRetrying()&&4===this.status()},b.prototype.isFailed=function(){return this.isDone()&&!a.isEmpty(this.error)},b.prototype.isResponseMeaningFailed=function(){return this.isFailed()&&this._is_response_meaning_failed},b.prototype.isSuccess=function(){return this.isDone()&&a.isEmpty(this.error)},b.prototype.isAborted=function(){return this.error&&this.error.code===a.M.AJAX_ABORTED},b.prototype.isLastRetryTime=function(){return this.isRetrying()&&this.options.retry&&this.retry_time>=parseInt(this.options.retry)},b.prototype.isRetryable=function(){if(!a.isEmpty(this.error)&&!this.isAborted()&&!this.isResponseMeaningFailed()&&this.options.retry&&this.retry_time<parseInt(this.options.retry)){var b;return b=a.isFunction(this.options.is_continue)?this.options.is_continue.bind(this)(a.clone(this.error)):Boolean(this.options.is_continue)}return!1},b.prototype.request=function(a){return h(this,a)},b.prototype.abort=function(){this.isRequesting()&&this.jqXHR.abort?this.jqXHR.abort():this.isRetrying()&&(clearTimeout(this._retry_timeout_id),this.emitEvent("aborted"),e(this))},["get","post","put","delete"].forEach(function(a){b.prototype[a]=function(b,c,d,e){return i.apply(null,[this,a.toUpperCase()].concat(Array.prototype.slice.call(arguments,0)))}}),["get","post"].forEach(function(c){b.prototype[c+"JSON"]=function(b,c,d){var e=a.M.optionalArgs(Array.prototype.slice.call(arguments,0,3),["url","data","callback"],{url:"string",data:["string","Object"],callback:"Function"}),f={dataType:"json"};return e.url&&(f.url=e.url),e.data&&(f.data=e.data),e.callback&&(f.done=e.callback),this.request(f)}}),["get","post","put","delete","getJSON","postJSON"].forEach(function(a){b[a]=function(c,d,e,f){var g=new b;return g[a].apply(g,Array.prototype.slice.call(arguments,0)),g}}),b.prototype.query=function(a){var b={method:"GET"};return a&&(b.data=a),this.request(b)},b.prototype.send=function(a){var b={method:"POST"};return a&&(b.data=a),this.request(b)},b.use=function(c,d){return new b(a.M.PreOptions.get(c,d))},b.load=function(c,d,e){var f=new b;return a.isObject(e)||(e={}),e=a.extend({error_content:"",apply_type:"replace"},e,{url:c}),f.option(e),f.done(function(a){j(a,d,e.apply_type)}).fail(function(b,c){var g="";e.error_content&&(g=a.isFunction(e.error_content)?e.error_content(f,b,c):e.error_content+""),j(g,d,e.apply_type)}),f.request(),f},a.M.AJAX=b}(_);
//# sourceMappingURL=madnh.min.js.map
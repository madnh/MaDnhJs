!function(a,b){"function"==typeof define&&define.amd?define(["lodash","madnhjs","madnhjs_preoptions","madnhjs_event_emitter","madnhjs_template","madnhjs_dialog_button"],function(c,d,e,f,g,h){return a.Dialog=b(a,c,d,e,f,g,h)}):a.Dialog=b(a,a._,a.M,a.PreOptions,a.EventEmitter,a.Template,a.DialogButton)}(this,function(a,b,c,d,e,f,g){function h(a){return a.isEnable()}function i(a){return a.isEnable()}function j(a){var b={status:n.STATUS_INITIAL,enabled:!0,pending:!1,loading:!1,ajax_worker:null,template_instance:null};o.hasOwnProperty(a)&&(b.template_instance=o[a].template_instance),o[a]=b}function k(a){this.type_prefix="dialog";var c=this;e.call(this),this.options=d.get(n.PRE_OPTIONS_NAME),this.closed_by="",this.data={},this.buttons={},j(this.id),this.option(this.options),a&&(a.hasOwnProperty("events")&&a.events&&(this.addListeners(a.events),delete a.events),a.hasOwnProperty("buttons")&&a.buttons&&(b.each(a.buttons,function(a){c.attachButton(a)}),delete a.buttons),this.option(a))}function l(a){b.isFunction(this.options.content_handler)&&(a=this.options.content_handler(a,this)),this.emitEvent("content_loaded",a),this.updateContent(a)}var m="1.0.0",n={PRE_OPTIONS_NAME:"M.Dialog",TEMPLATE_TYPE:"Dialog",STATUS_INITIAL:"initial",STATUS_OPENED:"opened",STATUS_HIDING:"hiding",STATUS_CLOSED:"removed",TYPE_INFO:"info",TYPE_SUCCESS:"success",TYPE_PRIMARY:"primary",TYPE_WARNING:"warning",TYPE_DANGER:"danger",SIZE_SMALL:"small",SIZE_NORMAL:"normal",SIZE_LARGE:"large"},o={};return d.define(n.PRE_OPTIONS_NAME,{title:"Dialog",type:n.TYPE_INFO,content:"",content_handler:null,template_name:"",template:{},size:n.SIZE_NORMAL,classes:"",closable:h,clickable:i}),c.inherit(k,e),c.defineConstant(k,"version",m),c.defineConstant(k,n),k.globalOption=function(a){d.update(k.PRE_OPTIONS_NAME,a)},k.prototype.getContent=function(){return b.isFunction(this.options.content)&&(this.emitEvent("load_content"),this.options.content=this.options.content(l.bind(this),this)),b.isFunction(this.options.content_handler)?this.options.content_handler(this.options.content,this):this.options.content},k.prototype.updateContent=function(a){this.options.content=a,this.isOpened()&&this.emitEvent("update_content",a)},k.prototype.setTemplate=function(a){if(!this.isIniting())throw new Error("Dialog is opened");if(!(a instanceof f))throw new Error("Invalid Template instance");o[this.id].template_instance&&(o[this.id].template_instance.disconnect(),o[this.id].template_instance=null),a.option(this.options.template),o[this.id].template_instance=a,a.connect(this)},k.prototype.getTemplate=function(){if(!o[this.id].template_instance){if(!this.options.template_name){var a=d.get(k.PRE_OPTIONS_NAME);if(a.template_name&&f.hasTemplate(k.TEMPLATE_TYPE,a.template_name))this.options.template_name=a.template_name;else{var b=f.defaultTemplate(k.TEMPLATE_TYPE);if(!1===b)throw new Error("Dialog default template not found");this.options.template_name=b,d.update(k.PRE_OPTIONS_NAME,{template_name:b})}}this.setTemplate(f.templateInstance(k.TEMPLATE_TYPE,this.options.template_name))}return o[this.id].template_instance},k.prototype.option=function(a,d){var e=c.beObject.apply(c,b.toArray(arguments));return e.template_name&&this.setTemplate(f.templateInstance(k.TEMPLATE_TYPE,e.template_name)),e.template&&this.getTemplate().option(e.template),b.extend(this.options,e),this},k.prototype.status=function(){return o.hasOwnProperty(this.id)?o[this.id].status:!1},k.prototype.isIniting=function(){return this.status()===k.STATUS_INITIAL},k.prototype.isOpened=function(){return-1!==[k.STATUS_OPENED,k.STATUS_HIDING].indexOf(this.status())},k.prototype.isVisibling=function(){return this.status()===k.STATUS_OPENED},k.prototype.isHiding=function(){return this.status()===k.STATUS_HIDING},k.prototype.isClosed=function(){return this.status()===k.STATUS_CLOSED},k.prototype.isEnable=function(){return Boolean(o[this.id].enabled)},k.prototype.isPending=function(){return Boolean(o[this.id].pending)},k.prototype.enable=function(){return this.isEnable()?!1:(o[this.id].enabled=!0,this.emitEvent("enabled"),this.emitEvent("toggle_enable",!0),!0)},k.prototype.disable=function(){return this.isEnable()?(o[this.id].enabled=!1,this.emitEvent("disabled"),this.emitEvent("toggle_enable",!1),!0):!1},k.prototype.pending=function(){return this.isPending()?!1:(o[this.id].pending=!0,this.emitEvent("pending"),this.emitEvent("toggle_pending",!0),!0)},k.prototype.resolved=function(){return this.isPending()?(o[this.id].pending=!1,this.emitEvent("resolved"),this.emitEvent("toggle_pending",!1),!0):!1},k.prototype.attachButton=function(c){if(!(c instanceof a.DialogButton))if(b.isObject(c))c=new g(c);else{if(!b.isString(c)&&!b.isNumber(c)||!g.has(c))throw new Error("Invalid button");c=g.factory(c)}return this.buttons[c.options.name]=c,c.listen(this),c},k.prototype.attachMultiButtons=function(a){var c=this;b.each(a,function(a){c.attachButton(a)})},k.prototype.hasButton=function(a){return this.buttons.hasOwnProperty(a)},k.prototype.getButton=function(a){if(!this.hasButton(a))throw new Error("Get unattached button");return this.buttons[a]},k.prototype.removeButton=function(a){if(!this.hasButton(a))throw new Error("Remove unattached button");this.buttons[a].unlisten(this),delete this.buttons[a]},k.prototype.isClickable=function(){return this.options.clickable?b.isFunction(this.options.clickable)?this.options.clickable(this):Boolean(this.options.clickable):!0},k.prototype.click=function(a){if(this.isClickable()&&this.hasButton(a)){var b=this.getButton(a);b.click(),this.emitEvent("clicked",a)}return!1},k.prototype.isCloseable=function(){return this.isOpened()?this.options.closable?b.isFunction(this.options.closable)?this.options.closable(this):Boolean(this.options.closable):!0:!1},k.prototype.open=function(){return this.status()===k.STATUS_INITIAL?(o[this.id].template_instance||this.getTemplate(),this.closed_by="",o[this.id].status=k.STATUS_OPENED,this.emitEvent("open"),!0):!1},k.prototype.hide=function(){return this.isVisibling()?(this.emitEvent("hide"),o[this.id].status=k.STATUS_HIDING,!0):!1},k.prototype.show=function(){return this.isHiding()?(this.emitEvent("show"),o[this.id].status=k.STATUS_OPENED,!0):!1},k.prototype.close=function(a,b){return this.isClosed()||!a&&!this.isCloseable()?!1:(b=b||"",this.emitEvent("close",a,b),j(this.id),o[this.id].status=k.STATUS_CLOSED,this.closed_by=b,this.emitEvent("closed",a,b),this.reset(),!0)},k.prototype.setClosedBy=function(c){return this.isClosed()?(c||(c=""),c instanceof a.DialogButton&&(c=c.getCloseKey()),b.isString(c)||(c+=""),this.closed_by=c,!0):!1},k.prototype.isClosedBy=function(c){return this.isClosed()?(c||(c=""),c instanceof a.DialogButton&&(c=c.getCloseKey()),b.isString(c)||(c+=""),this.closed_by===c):!1},k.prototype.getDOM=function(){return o[this.id].template_instance&&o[this.id].template_instance instanceof f?o[this.id].template_instance.getDOM():!1},k}),function(a,b){"function"==typeof define&&define.amd?define(["lodash","madnhjs","madnhjs_preoptions","madnhjs_event_emitter","madnhjs_template","madnhjs_dialog"],function(c,d,e,f,g,h){return a.DialogButton=b(c,d,e,f,g,h)}):a.DialogButton=b(a._,a.M,a.PreOptions,a.EventEmitter,a.Template,a.Dialog)}(this,function(a,b,c,d,e,f){function g(a){return a.isVisible()&&a.isEnable()&&a.getDialog().isClickable()}function h(a){a.on("listen",i),a.on("unlisten",j),a.on("dialog.toggle_enable",k),a.on("dialog.toggle_pending",l)}function i(a){a instanceof f&&(p[this.id].dialog=a)}function j(a){a instanceof f&&(p[this.id].dialog=null)}function k(a){this.toggleEnable(a.data)}function l(a){a.data?this.options.disable_on_pending&&this.toggleEnable(!1):this.toggleEnable(!0)}function m(a){this.type_prefix="dialog_button",d.call(this),this.options=c.get(o.PRE_OPTIONS_NAME,{name:this.id}),p[this.id]={dialog:null,enabled:!0,visible:!0,template_instance:null},this.option(this.options),a&&(a.hasOwnProperty("events")&&(this.addListeners(a.events),delete a.events),this.option(a)),h(this)}var n="1.0.0",o={PRE_OPTIONS_NAME:"M.DialogButton",TEMPLATE_TYPE:"DialogButton",TYPE_INFO:"info",TYPE_PRIMARY:"primary",TYPE_SUCCESS:"success",TYPE_WARNING:"warning",TYPE_DANGER:"danger",OK:"ok",CANCEL:"cancel",YES:"yes",NO:"no",RETRY:"retry",BUTTONS_OK_ONLY:["ok"],BUTTONS_OK_CANCEL:["ok","cancel"],BUTTONS_YES_NO:["yes","no"],BUTTONS_YES_NO_CANCEL:["yes","no","cancel"],BUTTONS_RETRY_CANCEL:["retry","cancel"]},p={};c.define(o.PRE_OPTIONS_NAME,{label:"Untitled",icon:"",type:o.TYPE_INFO,size:1,handler:null,disable_on_pending:!0,clickable:g,template_name:"",template:{}}),b.inherit(m,d),b.defineConstant(m,"version",n),b.defineConstant(m,o),m.globalOption=function(a){c.update(m.PRE_OPTIONS_NAME,a)},m.prototype.setTemplate=function(a){if(!(a instanceof e))throw new Error("Invalid Template instance");p[this.id].template_instance&&(p[this.id].template_instance.disconnect(),p[this.id].template_instance=null),a.option(this.options.template),p[this.id].template_instance=a,a.connect(this)},m.prototype.getTemplate=function(){if(!p[this.id].template_instance){if(!this.options.template_name){var a=c.get(m.PRE_OPTIONS_NAME);if(a.template_name&&e.hasTemplate(m.TEMPLATE_TYPE,a.template_name))this.options.template_name=a.template_name;else{var b=e.defaultTemplate(m.TEMPLATE_TYPE);if(!1===b)throw new Error("Dialog button default template not found");this.options.template_name=b,c.update(m.PRE_OPTIONS_NAME,{template_name:b})}}this.setTemplate(e.templateInstance(m.TEMPLATE_TYPE,this.options.template_name))}return p[this.id].template_instance},m.prototype.option=function(c,d){var f=b.beObject.apply(b,a.toArray(arguments));return f.template_name&&this.setTemplate(e.templateInstance(m.TEMPLATE_TYPE,f.template_name)),f.template&&this.getTemplate().option(f.template),a.extend(this.options,a.omit(f,["template_name"])),this},m.prototype.setHandler=function(a){this.option("handler",a)},m.prototype.getDialog=function(){return p[this.id].dialog?p[this.id].dialog:!1},m.prototype.isClickable=function(){return a.isFunction(this.options.clickable)?this.options.clickable.call(this,this):Boolean(this.options.clickable)},m.prototype.isVisible=function(){return Boolean(p[this.id].visible)},m.prototype.isEnable=function(){return Boolean(p[this.id].enabled)},m.prototype.click=function(){return this.isClickable()?(this.emitEvent("click"),this.options.handler&&b.callFunc(this.options.handler,this,this),this.emitEvent("clicked"),!0):!1},m.prototype.toggle=function(b){a.isUndefined(b)&&(b=!p[this.id].visible),p[this.id].visible!=b&&(p[this.id].visible=b,b?this.emitEvent("show"):this.emitEvent("hide"),this.emitEvent("toggle",b))},m.prototype.show=function(){this.toggle(!0)},m.prototype.hide=function(){this.toggle(!1)},m.prototype.toggleEnable=function(b){a.isUndefined(b)&&(b=!p[this.id].enabled),p[this.id].enabled!==b&&(p[this.id].enabled=b,this.emitEvent(b?"enabled":"disabled"),this.emitEvent("toggle_enable",b))},m.prototype.disable=function(){this.toggleEnable(!1)},m.prototype.enable=function(){this.toggleEnable(!0)},m.prototype.render=function(){return this.getTemplate().render()},m.prototype.reDraw=function(){return p[this.id].template_instance?p[this.id].template_instance.reDraw():!1},m.prototype.getDOM=function(){return p[this.id].template_instance&&p[this.id].template_instance instanceof e?p[this.id].template_instance.getDOM():!1},m.prototype.getOtherButton=function(a){return this.getDialog().getButton(a)},m.prototype.getCloseKey=function(){return this.options.name},m.prototype.closeDialog=function(a){var b=this.getDialog();return b?(b.close(a,this.getCloseKey()),!0):!1},m.prototype.wasCloseDialog=function(){var a=this.getDialog();return a?a.setClosedBy(this):!1};var q={};return m.isDefined=function(a){return q.hasOwnProperty(a)},m.define=function(b,c,d){q[b]={options:a.isObject(c)?c:{},freeze_options:a.isObject(d)?d:{}},q[b].freeze_options.name=b},m.updateOptions=function(b,c){return m.isDefined(b)?(a.extend(q[b].options,c),!0):!1},m.factory=function(b,c,d){a.isObject(c)||(c={}),a.isObject(d)||(d={});var e=a.castArray(b).map(function(b){var e,f;if(!m.isDefined(b))throw new Error("Dialog Button type is unregistered");return f=q[b],e=a.extend({},f.options,a.clone(c),d.hasOwnProperty(b)?d[b]:{},f.freeze_options),new m(e)});return 1==e.length?e.shift():e},m.defaultClickable=g,a.each(["Ok","Yes","No","Retry","Ignore"],function(a){m.define(a.toLowerCase(),{label:a})}),m.define("cancel",{label:"Cancel",disable_on_pending:!1}),function(){function a(a){var b=a.getDialog();b&&a.closeDialog(Boolean(a.options.force))}b.defineConstant(m,{BUTTON_CLOSE:"close"}),m.define(m.BUTTON_CLOSE,{label:"Close",type:m.TYPE_INFO,force:!1},{handler:a})}(),m}),function(a,b){"function"==typeof define&&define.amd?define(["lodash","madnhjs","madnhjs_preoptions","madnhjs_ajax","madnhjs_dialog","madnhjs_dialog_button"],b):b(a._,a.M,a.PreOptions,a.Ajax,a.Dialog,a.DialogButton)}(this,function(a,b,c,d,e,f){function g(a){return function(c){var d=c.getDialog();c.closeDialog(!0),b.callFunc(a,[c.options.name,null,c,d],d)}}function h(a,c){return function(d){var e=this.getDialog(),f=$(e.data.form_selector),g=!0;return k(e,!1),c.validator&&(g=c.validator(f,e)),!0!==g?void k(e,g):void b.callFunc(a,[d.options.name,f,d,e],e)}}function i(a){return['<form><div class="dialog_form_message"></div>',a,'<input type="submit" style="display: none;"/></form>'].join("")}function j(b){return a.isArray(b)||(b+"").split(" "),b=a.flatten(a.castArray(b)),a.isEmpty(b)?"":a.map(b,function(a){return a.trim()?"."+a:""}).join("")}function k(a,b){var c=$(a.data.form_selector+" "+a.data.form_message_selector);c.length&&(b?c.html(b).show():c.html("").hide())}function l(a,b){var c="#"+a.getTemplate().getDOMID(),d=c+" form"+j(b.form_classes),e=d+" "+b.message_classes?j(b.message_classes):".dialog_form_message";a.data.form_selector=d,a.data.form_message_selector=e}function m(a){a.getFormDOM=function(){return $(a.data.form_selector)},a.updateFormMessage=function(b){k(a,b)},a.clearFormMessage=function(){k(a,!1)},a.getFormData=function(){return b.jForm?b.jForm.getFormData(this.getFormDOM()):(console.warn("Method getFormData require module jForm"),{})}}function n(a,b){function c(c){return c.preventDefault(),b.submit_button_name&&a.click(b.submit_button_name),!1}a.on("open",function(){$("body").on("submit",this.data.form_selector,c)}),a.on("closed",function(){if(!this.closed_by&&b.cancel_button_name){if(!this.hasButton(b.cancel_button_name))throw new Error("Invalid default button");this.buttons[b.cancel_button_name].click()}},{key:"default_close_button"}),a.on("closed",function(){$("body").off("submit",this.data.form_selector,c)})}b.defineConstant(e,{DYNAMIC_CONTENT_PRE_OPTIONS_NAME:"M.Dialog.DynamicContent"}),c.define(e.DYNAMIC_CONTENT_PRE_OPTIONS_NAME,{loading:"Loading content..."}),e.dynamicContent=function(b){var f=null;return a.isString(b)&&(b={url:b}),b=c.get(e.DYNAMIC_CONTENT_PRE_OPTIONS_NAME,b),function(c,e){if(!a.isNull(f))return f;var g=new d(a.omit(b,"loading"));return g.done(function(a){f=a+"",c(f)}),g.fail(function(){e.emitEvent("load_content_failed"),c(b.error_content||"Get dynamic content failed")}),g.option("before_send",function(){return e.emitEvent("load_content"),e.pending(),!0}),g.always(function(){e.emitEvent("load_content_complete"),e.resolved()}),e.on("close",function(){g.abort()}),g.request(),b.loading}},b.defineConstant(e,{DIALOG_ALERT_PRE_OPTIONS_NAME:"M.Dialog.Alert"}),c.define(e.DIALOG_ALERT_PRE_OPTIONS_NAME,{title:"Alert",close_button_options:{}}),e.alert=function(d,f){a.isObject(f)||(f={title:f+""}),f=a.extend(c.get(e.DIALOG_ALERT_PRE_OPTIONS_NAME,f),{content:d});var g=new e(a.omit(f,"close_button_options"));return g.attachButton(b.DialogButton.factory("close",f.close_button_options)),g.open(),g},b.defineConstant(e,{DIALOG_CONFIRM_PRE_OPTIONS_NAME:"M.Dialog.Confirm"}),c.define(e.DIALOG_CONFIRM_PRE_OPTIONS_NAME,{title:"Confirm",default_button:null,buttons:[]}),e.confirm=function(d,g,h){var i;return a.isObject(h)||(h={title:h+""}),a.isFunction(g)||(g=a.noop),h=a.extend(c.get(e.DIALOG_CONFIRM_PRE_OPTIONS_NAME,h),{content:d}),a.isEmpty(h.buttons)&&(h.buttons=f.factory(f.BUTTONS_YES_NO)),i=new e(a.omit(h,"default_button")),a.each(i.buttons,function(a){a.setHandler(function(){this.closeDialog(),g(this.options.name)})}),h.default_button||(h.default_button=a.last(Object.keys(i.buttons))),i.on("closed",function(){this.closed_by||b.callFunc(g,h.default_button,null)},{key:"default_button"}),i.open(),i},b.defineConstant(e,{DIALOG_IFRAME_PRE_OPTIONS_NAME:"M.Dialog.iFrame"}),c.define(e.DIALOG_IFRAME_PRE_OPTIONS_NAME,{title:"iFrame",attributes:{}}),e.iFrame=function(b,d){var f,g=[],h=[];return a.isObject(d)||(d={title:d+""}),d=c.get(e.DIALOG_IFRAME_PRE_OPTIONS_NAME,d),a.each(d.attributes,function(b,c){a.isBoolean(b)?b&&g.push(c+'="'+c+'"'):g.push(c+'="'+b+'"')}),h.push('<div class="embed-responsive embed-responsive-16by9">'),h.push('<iframe class="embed-responsive-item" src="'+b+'" '+g.join(" ")+"></iframe>"),h.push("</div>"),d.content=h.join("\n"),f=new e(d),f.open(),f},f.define("submit",{label:"Submit"}),b.defineConstant(f,{SUBMIT:"submit",SUBMIT_CANCEL:["submit","cancel"]}),b.defineConstant(e,{DIALOG_FORM_PRE_OPTIONS_NAME:"M.Dialog.Form"}),c.define(e.DIALOG_FORM_PRE_OPTIONS_NAME,{title:"Form",form_classes:"",message_classes:"dialog_form_message",validator:null,auto_focus:!0,submit_button_name:"submit",cancel_button_name:"cancel",buttons:[],buttons_extend_options:{}}),e.form=function(b,d,j){var k=new e;return a.isFunction(d)||(d=a.noop),j=a.extend(c.get(e.DIALOG_FORM_PRE_OPTIONS_NAME,j),{content:b,content_handler:i}),a.isEmpty(j.buttons)&&(j.buttons=f.factory(f.SUBMIT_CANCEL,{},{cancel:{handler:g(d)},submit:{handler:h(d,j)}})),k.option(a.omit(j,["form_classes","message_classes","validator","submit_button_name","cancel_button_name","buttons","buttons_extend_options"])),a.each(j.buttons,function(b){var c=k.attachButton(b);j.buttons_extend_options.hasOwnProperty(c.options.name)&&c.option(a.clone(j.buttons_extend_options[c.options.name]))}),l(k,j),m(k,j),n(k,j),k.open(),j.auto_focus&&setTimeout(function(){k.getDOM().find("input:visible, textarea:visible").first().focus()},500),k},b.defineConstant(e,{DIALOG_PROMPT_PRE_OPTIONS_NAME:"M.Dialog.prompt"}),c.define(e.DIALOG_PROMPT_PRE_OPTIONS_NAME,{title:"Prompt",default_value:"",placeholder:"",input_type:"text",input_classes:"form-control",buttons_extend_options:{submit:{label:"Ok"}}}),e.prompt=function(b,d,f){function g(a,b,c){if(!b)return void d(!1);var e=f.default_value;"submit"===a&&(e=b.find('input[name="prompt_data"]').val(),c.closeDialog()),d(e)}var h,i=[];return a.isObject(f)||(f={title:f+""}),a.isFunction(d)||(d=a.noop),f=c.get(e.DIALOG_PROMPT_PRE_OPTIONS_NAME,f),i.push("<p>",b,"</p>"),i.push('<input name="prompt_data" type="',f.input_type+'" ','class="',f.input_classes+'" ','value="',f.default_value+'"','placeholder="',f.placeholder+'"',"/>"),h=e.form(i.join(""),g,a.omit(f,"default_value","placeholder","input_type","input_classes"))}}),function(a,b){"function"==typeof define&&define.amd?define(["lodash","madnhjs","madnhjs_preoptions","madnhjs_waiter","madnhjs_ajax","madnhjs_template","madnhjs_dialog","madnhjs_dialog_button"],b):b(a._,a.M,a.PreOptions,a.Waiter,a.Ajax,a.Template,a.Dialog,a.DialogButton)}(this,function(a,b,c,d,e,f,g,h){function i(a,b,c){var d=b.options.type?"bg-"+b.options.type:"";return'<div class="modal-header '+d+'"><button type="button" class="close" onclick="'+c.close_func+'()"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+b.options.title+"</h4></div>"}function j(a,b,c){var d=b.getContent(),e=[];return this.options.padding||e.push("padding: 0px;"),e.push("overflow: "+this.options.overflow+";"),['<div class="modal-body" style="',e.join(" "),'">',d,"</div>"].join("")}function k(b,c,d){var e=[],f='<div class="modal-footer" style="text-align: '+this.options.buttons_align+';">',g='<span class="dialog-pending-info text-muted pull-'+("left"===this.options.buttons_align?"right":"left")+'">'+this.options.pending_info+"</span>&nbsp;&nbsp;";return a.each(c.buttons,function(a){e.push(a.render())}),f+=e.join("\n")+g,f+="</div>"}function l(a,b,c){var d={large:"lg",small:"sm"},e="",f=['<div class="modal fade" tabindex="-1" role="dialog" id="<%= dom_id %>" data-dialog-id="',b.id,'" data-draw="<%- draw %>">'];return d.hasOwnProperty(this.options.size)&&(e="modal-"+d[this.options.size]),f.push('<div class="modal-dialog ',this.options.classes," ",e,'">','<div class="modal-content">'),this.options.has_header&&f.push("@HEADER@"),f.push("@BODY@"),this.options.has_footer&&f.push("@FOOTER@"),f.push("</div></div></div>"),f.join("")}function m(a){return{backdrop:a?"static":!0,keyboard:!a}}function n(){var a,b=m(this.options.close_manual),c=this.getDialog(),e={};e.close_func=d.createFunc(function(){this.getDialog().close()}.bind(this),!0,"Modal: "+c.id+" >>> Header close button"),this.waiter_keys.push(e.close_func),a=this.render(e),$("body").append(a),o(this),this.getDOM().modal(b)}function o(a){var b=a.getDOM();b.on("show.bs.modal",function(c){$(c.target).is(b)&&(s++,a.emitEvent("show"))}),b.on("shown.bs.modal",function(c){$(c.target).is(b)&&($("body .modal-backdrop").last().attr("id","modal-backdrop_"+a.id),a.emitEvent("shown"))}),b.on("hide.bs.modal",function(c){$(c.target).is(b)&&a.emitEvent("hide")}),b.on("hidden.bs.modal",function(c){$(c.target).is(b)&&(a.emitEvent("hidden"),a.getDialog().close())})}function p(){var a=this.getDialog().isCloseable(),b=this.getDOM();b.find(".modal-header .close").toggleClass("hide",!a)}function q(){if(!$.fn.modal)throw new Error("Dialog Bootstrap template require Bootstrap Modal to work");this.type_prefix="template_dialog_bootstrap",f.call(this),this.options=c.get(h.TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME),this.waiter_keys=[],this.setLayout(l),this.setSection("HEADER",i.bind(this)),this.setSection("BODY",j.bind(this)),this.setSection("FOOTER",k.bind(this)),this.mimic(["open","toggle_enable","close","hide","show","update_content"]),this.on("open",n.bind(this)),this.on("toggle_enable",p.bind(this)),this.on("close",function(){d.remove(this.waiter_keys),this.waiter_keys=[],this.getDOM().modal("hide"),this.getDOM().remove(),s=Math.max(0,--s),$("body").toggleClass("modal-open",s>0),s||$("body .modal-backdrop").remove(),$("#modal-backdrop_"+this.id).remove()}),this.on("hide",function(){this.getDOM().hide(),$("#modal-backdrop_"+this.id).hide()}),this.on("show",function(){this.getDOM().show(),$("#modal-backdrop_"+this.id).show()}),this.on("update_content",function(a){this.getDialog().isOpened()&&this.updateContent(a)})}var r="1.0.0";b.defineConstant(h,{TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME:"M.Dialog.Template.Bootstrap"}),c.define(h.TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME,{has_header:!0,has_footer:!0,close_manual:!0,padding:!0,classes:"",overflow:"hidden",buttons_align:"right",pending_info:""});var s=0;b.inherit(q,f),b.defineConstant(q,"version",r),q.prototype.getDialog=function(){return this.dataSource},q.prototype.updateContent=function(a){a||(a=this.getDialog().options.content),this.getDOM().find(".modal-body").html(a)},q.prototype.updatePendingInfo=function(a){this.getDOM().find(".dialog-pending-info").html(a)},f.register(g.TEMPLATE_TYPE,"Bootstrap",q)}),function(a,b){"function"==typeof define&&define.amd?define(["lodash","madnhjs","madnhjs_preoptions","madnhjs_waiter","madnhjs_ajax","madnhjs_template","madnhjs_dialog","madnhjs_dialog_button"],b):b(a._,a.M,a.PreOptions,a.Waiter,a.Ajax,a.Template,a.Dialog,a.DialogButton)}(this,function(a,b,c,d,e,f,g,h){function i(a,b,c){return b.options.icon?'<span class="<%= option.icon_class %>"><i class="<%= data_source.options.icon %>"></i></span>&nbsp;&nbsp;':""}function j(b,c,d){var e=a.clamp(c.options.size-1,0,4),f=a.times(3*e,a.constant("&nbsp;&nbsp;")).join(""),g="",h=[];return c.isVisible()||h.push("display: none"),g+='<button type="button" id="<%= dom_id %>" data-button-id="<%= data_source.id %>"',g+='data-draw="<%- draw %>" style="'+h.join("; ")+'"',g+='class="btn btn-<%= data_source.options.type %>" data-name="<%= data_source.options.name %>" ',g+='onclick="'+b.click_key+'()"',c.isEnable()||(g+=' disabled="disabled"'),g+=">",g+=f+"@ICON@@LABEL@"+f+"</button>"}function k(){this.type_prefix="template_dialog_button_bootstrap",f.call(this);var a=this;this.options=c.get(h.TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME),this.setLayout(j),this.setSection("ICON",i.bind(this)),this.setSection("LABEL",'<span class="<%= option.label_class %>"><%= data_source.options.label %></span>'),this.click_key=d.createFunc(function(){a.getButton().click()}),this.mimic(["toggle","toggle_enable"]),this.on("toggle",function(a){this.getDOM().toggle(a.data)}),this.on("toggle_enable",function(a){a?this.getDOM().removeAttr("disabled"):this.getDOM().attr("disabled","disabled"),this.getDOM().prop("disabled",!a)})}var l="1.0.0";b.defineConstant(h,{TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME:"M.DialogButton.Template.Bootstrap"}),c.define(h.TEMPLATE_BOOTSTRAP_PRE_OPTIONS_NAME,{icon_class:"dialog_button_icon",label_class:"dialog_button_label"}),b.inherit(k,f),b.defineConstant(k,"version",l),k.prototype.getButton=function(){return this.dataSource},k.prototype.updateLabel=function(a){this.getDOM().find("."+this.options.label_class).html(a)},k.prototype.updateIcon=function(a){this.getDOM().find("."+this.options.icon_class).html('<i class="'+a+'"></i>')},f.register(h.TEMPLATE_TYPE,"Bootstrap",k)});
//# sourceMappingURL=madnh_extensions.min.js.map